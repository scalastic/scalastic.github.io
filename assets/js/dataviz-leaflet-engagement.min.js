document.addEventListener("DOMContentLoaded",function(){var e=L.map("map",{center:[30,-2],zoom:2,minZoom:2,maxZoom:10,zoomDelta:.75,zoomSnap:1});L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/attribution">CARTO</a>',maxZoom:20}).addTo(e);var t=new HeatmapOverlay({radius:1.5,maxOpacity:.8,scaleRadius:!0,useLocalExtrema:!1,gradient:{.125:"rgb(173, 216, 230)",.25:"rgb(135, 206, 235)",.375:"rgb(0, 255, 255)",.5:"rgb(144, 238, 144)",.625:"rgb(255, 255, 0)",.75:"rgb(255, 165, 0)",.875:"rgb(255, 69, 0)",1:"rgb(128, 0, 128)"},latField:"l",lngField:"L",valueField:"c"}).addTo(e);fetch("/assets/js/dataviz-leaflet-engagement.min.json").then(e=>e.json()).then(a=>{var r,o;(r=a,o=new L.Control({position:"topright"}),o.onAdd=function(e){var a,o,s,d=L.DomUtil.create("div","custom-filter-control");return L.DomEvent.disableClickPropagation(d),l(d,r,"r","Referer"),l(d,r,"d","Device Type"),l(d,r,"o","OS"),a=d,o=r,(s=L.DomUtil.create("button","start-chrono-btn",a)).innerText="Visitor Time",L.DomEvent.on(s,"click",()=>{var e,a,r,l="t";return e=o,a=c,r=s,void(n?(clearInterval(i),n=!1,r.innerText="Visitor Time"):(function e(a,r,o,n){let l=a.map(e=>({...e,displayUntil:o(e[r])+30})),c=0;i=setInterval(()=>{var e,a,i;let s=l.filter(e=>{let t=o(e[r]);return t<=c&&c<=e.displayUntil});t.setData({data:s}),e=c,a=n,i=`${Math.floor(e/60).toString().padStart(2,"0")}:${(e%60).toString().padStart(2,"0")}`,a.innerText=`${i}`,(c+=10)>1439&&(c=0)},100)}(e,"t",a,r),n=!0))}),L.DomUtil.create("div","timeDisplay",d),d},o).addTo(e),a.forEach(e=>{e.c=1}),t.setData({data:a});let n=!1,i;function l(e,r,o,n){var i=document.createElement("option");i.value="all",i.innerText="All";var l=[...new Set(r.map(e=>e[o]))].sort(),c=L.DomUtil.create("select","select"+n.replace(/\s+/g,"_"),e);c.appendChild(i),l.forEach(e=>{var t=document.createElement("option");t.value=e,t.innerText=e,c.appendChild(t)}),L.DomEvent.on(c,"change",()=>{var e,r,o,n,i,l,c;return e=document.querySelector(".selectReferer"),r=document.querySelector(".selectDevice_Type"),o=document.querySelector(".selectOS"),n=e?e.value:"all",i=r?r.value:"all",l=o?o.value:"all",c=a.filter(function(e){var t="all"===n||e.r===n,a="all"===i||e.d===i,r="all"===l||e.o===l;return t&&a&&r}),void t.setData({data:c})})}function c(e){let t=new Date(1e3*e);return 60*t.getHours()+t.getMinutes()}function s(e){let[t,a]=e.split(":").map(Number);return 60*t+a}}),e.on("zoomend",function(){var a=e.getZoom();t.cfg.radius=Math.max(.1,1.5-a/5),t._update()})});