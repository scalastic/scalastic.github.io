<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="canonical" href="https://scalastic.io/en/ufw-fail2ban-nginx/"><link rel="alternate" hreflang="fr" href="https://scalastic.io/ufw-fail2ban-nginx/"><link rel="alternate" hreflang="en" href="https://scalastic.io/en/ufw-fail2ban-nginx/"><title>Turn Your Nginx Server into a Fortress with Fail2ban and UFW</title><meta name="title" content="Turn Your Nginx Server into a Fortress with Fail2ban and UFW"><meta name="description" content="The ultimate guide to securing your Nginx server on Ubuntu with Fail2ban and UFW. Practical tips for an infallible defense."><meta name="url" content="https://scalastic.io/en/ufw-fail2ban-nginx/"><meta name="robots" content="index, follow"><meta name="language" content="en"><meta name="author" content="Jean-Jerome Levy"><meta name="distribution" content="global"><meta name="rating" content="general"><meta name="application-name" content="Scalastic"><meta name="generator" content="Jekyll"><meta property="og:title" content="Turn Your Nginx Server into a Fortress with Fail2ban and UFW"><meta property="og:description" content="The ultimate guide to securing your Nginx server on Ubuntu with Fail2ban and UFW. Practical tips for an infallible defense."><meta property="og:url" content="https://scalastic.io/en/ufw-fail2ban-nginx/"><meta property="og:image" content="https://scalastic.io/assets/img/ufw-fail2ban-nginx.jpg"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="Scalastic"><meta property="og:type" content="article"><meta property="article:author" content="https://www.linkedin.com/in/jean-jerome-levy"><meta property="article:published_time" content="2023-12-23T18:34:00+01:00"><meta property="article:modified_time" content="2024-10-06T13:05:11+02:00"><meta property="article:section" content="Technology"><meta property="article:tag" content="UFW"><meta property="article:tag" content="Fail2ban"><meta property="article:tag" content="Nginx"><meta property="article:tag" content="Security"><meta property="article:tag" content="Cybersecurity"><meta property="article:tag" content="DevSecOps"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Turn Your Nginx Server into a Fortress with Fail2ban and UFW"><meta name="twitter:description" content="The ultimate guide to securing your Nginx server on Ubuntu with Fail2ban and UFW. Practical tips for an infallible defense."><meta name="twitter:url" content="https://scalastic.io/en/ufw-fail2ban-nginx/"><meta name="twitter:image" content="https://scalastic.io/assets/img/ufw-fail2ban-nginx.jpg"> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "BlogPosting", "url": "https://scalastic.io/en/ufw-fail2ban-nginx/", "headline": "Turn Your Nginx Server into a Fortress with Fail2ban and UFW", "description": "The ultimate guide to securing your Nginx server on Ubuntu with Fail2ban and UFW. Practical tips for an infallible defense.", "mainEntityOfPage":{ "@type": "WebPage", "@id": "https://scalastic.io/en/ufw-fail2ban-nginx/" }, "image": [ "https://scalastic.io/assets/img/ufw-fail2ban-nginx.jpg" ], "datePublished": "2023-12-23T18:34:00+01:00", "dateModified": "2024-10-06T13:05:11+02:00", "keywords": [ ["UFW", "Fail2ban", "Nginx", "Security", "Cybersecurity", "DevSecOps"] ], "isAccessibleForFree": "True", "isPartOf": { "@type": ["CreativeWork", "Product", "WebSite"], "name": "Scalastic", "productID": "scalastic.io" }, "inLanguage": "en-US", "license": "https://creativecommons.org/licenses/by-nc-nd/4.0/", "author": { "@type": "Person", "name": "Jean-Jerome Levy", "description": "Seasoned professional in the field of information technology, I bring over 20 years of experience from working within major corporate IT departments. My diverse expertise has played a pivotal role in a myriad of projects, marked by the implementation of innovative DevOps practices.", "jobTitle": "DevOps Consultant", "sameAs":[ "https://www.linkedin.com/in/jean-jerome-levy", "https://github.com/jeanjerome", "https://github.com/scalastic", "https://hub.docker.com/u/jeanjerome" ] }, "publisher": { "@type": "Organization", "name": "Scalastic", "description": "A company specializing in DevOps and Cloud", "url": "https://scalastic.io", "sameAs": [ "https://github.com/scalastic" ], "logo": { "@type": "ImageObject", "url": "https://scalastic.io/assets/img/logo-scalastic.svg" } } } </script><link rel="mask-icon" href="https://scalastic.io/en/pinned-scalastic.svg" color="#000000"><link rel="alternate icon" type="image/png" href="https://scalastic.io/en/favicon.png"><link rel="icon" type="image/svg+xml" href="https://scalastic.io/en/favicon.svg"><meta name="theme-color" content="#515151"><meta name="color-scheme" content="light dark"><meta name="coverage" content="Worldwide" ><meta name="distribution" content="Global" ><meta name="HandheldFriendly" content="True" ><meta name="msapplication-tap-highlight" content="no" ><link rel="apple-touch-icon" href="https://scalastic.io/en/favicon-36.png"><link rel="apple-touch-icon" sizes="180x180" href="https://scalastic.io/en/favicon-180-precomposed.png"><meta name="apple-mobile-web-app-title" content="Scalastic"><link rel="manifest" href="/en/manifest.webmanifest"><style> @font-face { font-family: 'Mulish'; font-style: normal; font-display: swap; src: url(/assets/fonts/mulish.woff2) format('woff2'); unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD; }</style><script> localStorage.getItem('darkMode') === 'true' && document.documentElement.setAttribute('data-mode', 'dark'); </script><link rel="stylesheet" href="/assets/css/main.css" ></head><body><div class="wrapper"><aside class="sidebar"><header><div class="about"><div class="cover-logo"> <a href="https://scalastic.io/en/" aria-label="Home"> <svg class="logo" viewBox="0 0 453 121" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"> <g id="logo"> <g id="label"><path id="Scalastic" d="M134.905 97.588 C130.07 97.588 126.312 96.33 123.633 93.815 120.955 91.299 119.616 87.364 119.616 82.006 119.616 77.498 120.515 72.532 122.311 67.11 124.108 61.687 126.982 57 130.934 53.047 134.887 49.095 139.901 47.118 145.977 47.118 149.897 47.118 152.69 47.968 154.356 49.666 156.022 51.365 156.856 53.52 156.856 56.133 156.856 58.42 156.365 60.185 155.385 61.426 154.405 62.667 153.165 63.287 151.663 63.287 150.552 63.287 149.407 62.896 148.231 62.112 149.015 59.956 149.409 58.029 149.409 56.33 149.409 55.089 149.179 54.11 148.721 53.391 148.264 52.672 147.579 52.313 146.665 52.313 144.705 52.313 142.744 53.912 140.784 57.114 138.824 60.315 137.222 64.202 135.981 68.776 134.74 73.349 134.12 77.465 134.12 81.123 134.12 84.325 134.675 86.498 135.786 87.641 136.896 88.784 138.694 89.356 141.176 89.356 144.704 89.356 147.726 88.54 150.241 86.907 152.401 85.504 154.743 83.474 157.264 80.819 157.387 76.282 158.343 71.533 160.139 66.571 162.067 61.246 164.94 56.739 168.762 53.047 172.584 49.356 177.142 47.51 182.434 47.51 185.113 47.51 187.106 47.967 188.413 48.881 189.719 49.796 190.372 51.005 190.372 52.508 L190.372 53.194 191.45 48 205.561 48 198.507 81.321 C198.245 82.301 198.114 83.345 198.114 84.455 198.114 87.265 199.453 88.67 202.132 88.67 203.961 88.67 205.546 87.82 206.885 86.121 208.225 84.423 209.285 82.201 210.069 79.457 L220.555 30.36 235.059 28.401 223.79 81.321 C223.528 82.301 223.397 83.345 223.397 84.455 223.397 85.762 223.708 86.693 224.329 87.248 224.949 87.804 225.979 88.082 227.417 88.082 229.311 88.082 231.074 87.283 232.708 85.682 233.599 84.808 234.354 83.791 234.973 82.635 234.967 82.363 234.962 82.09 234.962 81.811 234.962 76.976 235.925 71.895 237.852 66.571 239.78 61.246 242.655 56.739 246.477 53.047 250.299 49.356 254.855 47.51 260.147 47.51 262.826 47.51 264.819 47.967 266.126 48.881 267.432 49.796 268.087 51.005 268.087 52.508 L268.087 53.194 269.165 48 283.276 48 276.219 81.321 C275.958 82.301 275.829 83.345 275.829 84.455 275.829 87.265 277.168 88.67 279.846 88.67 281.676 88.67 283.259 87.82 284.598 86.121 284.628 86.084 284.657 86.044 284.686 86.006 284.661 85.687 284.647 85.366 284.647 85.043 284.647 82.887 285.154 81.009 286.167 79.409 287.179 77.808 288.405 76.649 289.842 75.93 292.39 71.357 294.612 66.734 296.507 62.063 298.401 57.391 300.197 52.345 301.895 46.922 L316.399 44.961 C316.726 53.324 317.281 62.373 318.065 72.108 318.392 76.028 318.555 78.869 318.555 80.633 318.555 82.136 318.426 83.378 318.165 84.358 321.235 82.594 323.586 80.96 325.219 79.457 L331.1 51.92 327.866 51.92 328.649 48 331.883 48 334.825 34.477 349.329 32.516 345.997 48 351.876 48 351.092 51.92 345.212 51.92 338.94 81.321 C338.679 82.301 338.548 83.345 338.548 84.455 338.548 85.762 338.859 86.693 339.479 87.248 340.1 87.804 341.128 88.082 342.565 88.082 344.46 88.082 346.225 87.283 347.858 85.682 349.491 84.081 350.667 82.005 351.385 79.457 L358.049 48 372.163 48 365.106 81.321 C364.845 82.301 364.714 83.345 364.714 84.455 364.714 85.762 365.025 86.693 365.645 87.248 366.266 87.804 367.294 88.082 368.731 88.082 370.626 88.082 372.391 87.283 374.024 85.682 374.626 85.093 375.164 84.437 375.641 83.719 375.609 83.165 375.592 82.595 375.592 82.006 375.592 77.498 376.491 72.532 378.288 67.11 380.084 61.687 382.958 57 386.911 53.047 390.863 49.095 395.878 47.118 401.954 47.118 405.939 47.118 408.748 47.968 410.382 49.666 412.015 51.365 412.833 53.554 412.833 56.233 412.833 58.585 412.326 60.348 411.313 61.524 410.301 62.7 409.075 63.287 407.637 63.287 406.396 63.287 405.253 62.896 404.208 62.112 404.992 60.021 405.383 58.094 405.383 56.33 405.383 53.652 404.503 52.313 402.739 52.313 400.779 52.313 398.818 53.928 396.858 57.162 394.898 60.396 393.281 64.252 392.007 68.727 390.733 73.202 390.096 77.074 390.096 80.34 390.096 85.763 392.055 88.475 395.975 88.475 397.739 88.475 399.716 87.936 401.905 86.858 404.094 85.78 406.036 84.522 407.735 83.084 405.971 92.754 400.321 97.588 390.782 97.588 386.013 97.588 382.289 96.33 379.61 93.815 378.38 92.659 377.432 91.203 376.766 89.448 375.418 91.303 373.948 92.759 372.358 93.815 368.569 96.33 364.813 97.588 361.089 97.588 357.953 97.588 355.42 96.609 353.493 94.649 352.141 93.274 351.266 91.417 350.862 89.078 349.442 91.11 347.886 92.69 346.192 93.815 342.403 96.33 338.647 97.588 334.923 97.588 331.787 97.588 329.254 96.609 327.327 94.649 325.4 92.689 324.436 89.748 324.436 85.828 324.436 85.386 324.457 84.905 324.495 84.391 321.444 87.137 318.061 89.576 314.342 91.707 312.448 93.733 310.111 95.219 307.335 96.166 304.558 97.114 301.765 97.588 298.956 97.588 295.82 97.588 293.174 96.984 291.018 95.776 288.862 94.567 287.261 92.998 286.216 91.071 286.17 90.986 286.126 90.901 286.083 90.817 285.088 92.034 284.037 93.034 282.932 93.815 279.372 96.33 275.795 97.588 272.202 97.588 269.458 97.588 267.253 96.821 265.587 95.285 263.921 93.75 262.925 91.513 262.598 88.573 260.704 91.251 258.595 93.422 256.276 95.088 253.957 96.754 251.198 97.588 247.997 97.588 244.273 97.588 241.169 96.314 238.686 93.766 237.438 92.485 236.504 90.84 235.883 88.832 234.418 90.984 232.804 92.645 231.042 93.815 227.252 96.33 223.496 97.588 219.772 97.588 216.636 97.588 214.104 96.609 212.176 94.649 210.849 93.299 209.98 91.484 209.567 89.203 208.227 91.176 206.779 92.713 205.219 93.815 201.659 96.33 198.082 97.588 194.489 97.588 191.745 97.588 189.54 96.821 187.874 95.285 186.208 93.75 185.21 91.513 184.883 88.573 182.989 91.251 180.883 93.422 178.563 95.088 176.244 96.754 173.483 97.588 170.282 97.588 166.558 97.588 163.454 96.314 160.971 93.766 159.132 91.878 157.975 89.199 157.499 85.733 151.099 93.635 143.569 97.588 134.905 97.588 Z M295.819 89.846 C298.236 89.846 300.262 89.127 301.895 87.69 303.529 86.252 304.346 83.934 304.346 80.733 304.346 78.773 304.15 76.028 303.758 72.5 303.105 65.052 302.679 60.054 302.483 57.506 300.915 62.668 298.27 68.841 294.546 76.028 296.048 76.812 296.799 77.955 296.799 79.457 296.799 80.699 296.392 81.809 295.575 82.789 294.758 83.769 293.73 84.26 292.489 84.26 291.507 84.26 290.778 84.042 290.298 83.608 290.171 83.898 290.044 84.185 289.915 84.465 290.078 86.078 290.526 87.317 291.262 88.18 292.21 89.291 293.728 89.846 295.819 89.846 Z M176.651 88.082 C178.284 88.082 179.902 87.315 181.503 85.78 183.103 84.244 184.198 82.136 184.786 79.457 L189.491 57.311 C189.491 56.462 189.164 55.628 188.51 54.811 187.857 53.994 186.843 53.586 185.471 53.586 182.858 53.586 180.507 55.105 178.417 58.143 176.326 61.181 174.692 64.84 173.516 69.119 172.34 73.399 171.753 77.171 171.753 80.438 171.753 83.704 172.225 85.795 173.173 86.709 174.12 87.624 175.279 88.082 176.651 88.082 Z M254.366 88.082 C255.999 88.082 257.617 87.315 259.217 85.78 260.818 84.244 261.913 82.136 262.501 79.457 L267.204 57.311 C267.204 56.462 266.877 55.628 266.223 54.811 265.57 53.994 264.558 53.586 263.186 53.586 260.573 53.586 258.22 55.105 256.13 58.143 254.039 61.181 252.405 64.84 251.229 69.119 250.053 73.399 249.466 77.171 249.466 80.438 249.466 83.704 249.94 85.795 250.887 86.709 251.835 87.624 252.994 88.082 254.366 88.082 Z M367.753 42.707 C365.597 42.707 363.767 41.956 362.264 40.453 360.762 38.951 360.01 37.121 360.01 34.965 360.01 32.809 360.762 30.963 362.264 29.428 363.767 27.893 365.597 27.125 367.753 27.125 369.909 27.125 371.754 27.893 373.29 29.428 374.825 30.963 375.592 32.809 375.592 34.965 375.592 37.121 374.825 38.951 373.29 40.453 371.754 41.956 369.909 42.707 367.753 42.707 Z M89.04 98.764 C84.924 98.764 81.298 98.045 78.162 96.608 75.026 95.171 72.609 93.162 70.91 90.581 69.211 88 68.362 85.011 68.362 81.614 68.362 78.739 68.966 76.126 70.175 73.774 71.384 71.422 73.017 69.56 75.075 68.188 77.133 66.816 79.403 66.13 81.886 66.13 84.173 66.13 86.1 66.702 87.668 67.845 89.236 68.988 90.216 70.573 90.608 72.598 87.211 72.598 84.499 73.496 82.474 75.293 80.449 77.09 79.436 79.523 79.436 82.594 79.436 85.403 80.285 87.657 81.984 89.356 83.683 91.055 85.937 91.904 88.746 91.904 92.209 91.904 95.067 90.744 97.321 88.425 99.575 86.106 100.702 83.182 100.702 79.654 100.702 76.583 99.853 73.676 98.154 70.932 96.455 68.188 93.907 64.856 90.51 60.936 86.982 56.885 84.32 53.406 82.523 50.499 80.726 47.592 79.828 44.407 79.828 40.944 79.828 37.547 80.775 34.492 82.67 31.781 84.565 29.07 87.178 26.93 90.51 25.362 93.842 23.794 97.599 23.01 101.78 23.01 107.072 23.01 111.302 24.251 114.471 26.734 117.64 29.217 119.224 32.549 119.224 36.73 119.224 39.474 118.538 41.695 117.166 43.394 115.794 45.093 113.997 45.942 111.776 45.942 109.293 45.942 107.301 44.929 105.798 42.904 107.039 41.989 108.019 40.781 108.738 39.278 109.457 37.775 109.816 36.207 109.816 34.574 109.816 32.483 109.195 30.817 107.954 29.576 106.713 28.335 105.014 27.714 102.858 27.714 100.245 27.714 98.105 28.645 96.439 30.507 94.773 32.369 93.94 34.737 93.94 37.612 93.94 40.225 94.691 42.659 96.194 44.913 97.697 47.167 100.049 50.058 103.25 53.586 105.863 56.395 107.97 58.813 109.571 60.838 111.172 62.863 112.544 65.199 113.687 67.845 114.83 70.491 115.402 73.349 115.402 76.42 115.402 80.601 114.242 84.391 111.923 87.788 109.604 91.185 106.435 93.864 102.417 95.824 98.399 97.784 93.94 98.764 89.04 98.764 Z" fill-opacity="1" stroke="none"/><path id=":" d="M61.577 57.992 C59.421 57.992 57.592 57.241 56.089 55.738 54.586 54.235 53.835 52.406 53.835 50.25 53.835 48.094 54.586 46.248 56.089 44.713 57.592 43.178 59.421 42.41 61.577 42.41 63.733 42.41 65.579 43.178 67.114 44.713 68.649 46.248 69.417 48.094 69.417 50.25 69.417 52.406 68.649 54.235 67.114 55.738 65.579 57.241 63.733 57.992 61.577 57.992 Z M56.677 81.512 C54.521 81.512 52.692 80.761 51.189 79.258 49.686 77.755 48.935 75.926 48.935 73.77 48.935 71.614 49.686 69.768 51.189 68.233 52.692 66.698 54.521 65.93 56.677 65.93 58.833 65.93 60.679 66.698 62.214 68.233 63.749 69.768 64.517 71.614 64.517 73.77 64.517 75.926 63.749 77.755 62.214 79.258 60.679 80.761 58.833 81.512 56.677 81.512 Z" fill-opacity="1" stroke="none"/> </g><path id="round" d="M57 10 C30.491 10 9 31.491 9 58 L9 64 C9 90.509 30.491 112 57 112 L397 112 C423.509 112 445 90.509 445 64 L445 58 C445 31.491 423.509 10 397 10 Z" fill="none" stroke-width="7" stroke-opacity="1" stroke-linejoin="round" stroke-linecap="round"/> </g> </svg> </a></div><div class="about-site"> Hello,<br>I am <a class='enhance' href='/en/jean-jerome-levy/'>Jean-Jerome Levy</a>, independent DevOps consultant<span class='nonmobile'> specializing in CI/CD, Docker, Kubernetes, and Cloud</span>.</div><div class="language-switcher"> <input type="radio" id="toggle-french" name="toggle" value="fr" onclick="window.location.assign( '/ufw-fail2ban-nginx/' );"> <label for="toggle-french" aria-label="Sélectionner le français">Français</label> <input type="radio" id="toggle-english" name="toggle" value="en" checked> <label for="toggle-english" aria-label="English is selected">English</label></div></div><div class="dark-mode-switcher " id="dark-mode-container"><div class="dark-mode-switch animated light"> <svg class="dark-mode-icon-dark" data-name="Layer 1" fill="#000000" height="20px" viewBox="0 0 64 64" width="20px" x="0px" xmlns="http://www.w3.org/2000/svg" y="0px"><title>essential</title><path d="M33.28,58.24A26.95,26.95,0,0,1,24,6l.39-.13a2,2,0,0,1,2.4,2.87,22.42,22.42,0,0,0-1.51,18.75h0A22.47,22.47,0,0,0,54.09,40.8l.76-.3a2,2,0,0,1,2.24.48,2,2,0,0,1,.35,2.24,27,27,0,0,1-24.16,15ZM21.11,11.85a22.94,22.94,0,1,0,30,33.91A26.46,26.46,0,0,1,21.53,28.87h0A26.4,26.4,0,0,1,21.11,11.85Z"></path> </svg> <svg class="dark-mode-icon-light" fill="#000000" height="20px" style="enable-background: new 0 0 100 100;" version="1.1" viewBox="0 0 100 100" width="20px" x="0px" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" y="0px"> <g><path d="M50,75c-13.8,0-25-11.2-25-25s11.2-25,25-25s25,11.2,25,25S63.8,75,50,75z M50,33.3c-9.2,0-16.7,7.5-16.7,16.7 c0,9.2,7.5,16.7,16.7,16.7c9.2,0,16.7-7.5,16.7-16.7C66.7,40.8,59.2,33.3,50,33.3z"></path> </g> <g><path d="M50,100c-2.3,0-4.2-1.9-4.2-4.2v-8.3c0-2.3,1.9-4.2,4.2-4.2c2.3,0,4.2,1.9,4.2,4.2v8.3C54.2,98.1,52.3,100,50,100z M17.5,86.7c-1.1,0-2.1-0.4-2.9-1.2c-1.6-1.6-1.6-4.3,0-5.9l5.8-5.8c1.6-1.6,4.3-1.6,5.9,0c1.6,1.6,1.6,4.3,0,5.9l-5.8,5.8 C19.6,86.3,18.6,86.7,17.5,86.7z M82.5,86.7c-1.1,0-2.1-0.4-2.9-1.2l-5.8-5.8c-1.6-1.6-1.6-4.3,0-5.9s4.3-1.6,5.9,0l5.8,5.8 c1.6,1.6,1.6,4.3,0,5.9C84.6,86.3,83.6,86.7,82.5,86.7z M95.8,54.2h-8.3c-2.3,0-4.2-1.9-4.2-4.2c0-2.3,1.9-4.2,4.2-4.2h8.3 c2.3,0,4.2,1.9,4.2,4.2C100,52.3,98.1,54.2,95.8,54.2z M12.5,54.2H4.2C1.9,54.2,0,52.3,0,50c0-2.3,1.9-4.2,4.2-4.2h8.3 c2.3,0,4.2,1.9,4.2,4.2C16.7,52.3,14.8,54.2,12.5,54.2z M76.7,27.5c-1.1,0-2.1-0.4-2.9-1.2c-1.6-1.6-1.6-4.3,0-5.9l5.8-5.8 c1.6-1.6,4.3-1.6,5.9,0c1.6,1.6,1.6,4.3,0,5.9l-5.8,5.8C78.8,27.1,77.7,27.5,76.7,27.5z M23.3,27.5c-1.1,0-2.1-0.4-2.9-1.2 l-5.8-5.8c-1.6-1.6-1.6-4.3,0-5.9c1.6-1.6,4.3-1.6,5.9,0l5.8,5.8c1.6,1.6,1.6,4.3,0,5.9C25.5,27.1,24.4,27.5,23.3,27.5z M50,16.7 c-2.3,0-4.2-1.9-4.2-4.2V4.2C45.8,1.9,47.7,0,50,0c2.3,0,4.2,1.9,4.2,4.2v8.3C54.2,14.8,52.3,16.7,50,16.7z"></path> </g> </svg><div class="ball"></div></div></div></header><footer><section class="contact"> <span class="contact-title">More</span><ul><li class="github"><a href="https://github.com/jeanjerome" aria-label="Author's GitHub" target="_blank" rel="noopener noreferrer nofollow"><span><svg width="17.44" height="18" viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path xmlns="http://www.w3.org/2000/svg" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></a></li><li class="linkedin"><a href="https://www.linkedin.com/in/jean-jerome-levy" aria-label="Author's LinkedIn Profile" rel="noopener noreferrer nofollow" target="_blank"><span><svg width="15.75" height="18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></span></a></li><li class="email"><a id="contact" aria-label="Email the webmaster"><span> <svg width="18" height="18"xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM0 176L0 384c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-208L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"/></svg></span></a></li><script> document.addEventListener("DOMContentLoaded",function(){let t=atob("amVhbmplcm9tZS5sZXZ5QGdtYWlsLmNvbQ==");let v=document.getElementById("contact");v.href="mailto:"+t;v.title=t;}) </script><li class="search"><a href="/en/search/" aria-label="Search" rel="search"><span> <svg width="18" height="18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg></span></a></li></ul></section><div class="contact nonmobile"><ul><li><a href="/en/legals/" aria-label="Legal Notice"><span><svg width="18" height="18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504.971 199.362l-22.627-22.627c-9.373-9.373-24.569-9.373-33.941 0l-5.657 5.657L329.608 69.255l5.657-5.657c9.373-9.373 9.373-24.569 0-33.941L312.638 7.029c-9.373-9.373-24.569-9.373-33.941 0L154.246 131.48c-9.373 9.373-9.373 24.569 0 33.941l22.627 22.627c9.373 9.373 24.569 9.373 33.941 0l5.657-5.657 39.598 39.598-81.04 81.04-5.657-5.657c-12.497-12.497-32.758-12.497-45.255 0L9.373 412.118c-12.497 12.497-12.497 32.758 0 45.255l45.255 45.255c12.497 12.497 32.758 12.497 45.255 0l114.745-114.745c12.497-12.497 12.497-32.758 0-45.255l-5.657-5.657 81.04-81.04 39.598 39.598-5.657 5.657c-9.373 9.373-9.373 24.569 0 33.941l22.627 22.627c9.373 9.373 24.569 9.373 33.941 0l124.451-124.451c9.372-9.372 9.372-24.568 0-33.941z"/></svg></span></a></li><li><a href="/en/sitemap.xml" aria-label="Sitemap"><span><svg width="22.5" height="18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M128 352H32c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32zm-24-80h192v48h48v-48h192v48h48v-57.59c0-21.17-17.23-38.41-38.41-38.41H344v-64h40c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H256c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h40v64H94.41C73.23 224 56 241.23 56 262.41V320h48v-48zm264 80h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32zm240 0h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32z"/></svg></span></a></li><li><a href="https://github.com/scalastic/scalastic.github.io" aria-label="Scalastic Website's GitHub" target="_blank" rel="noopener noreferrer nofollow"><span><svg width="22.5" height="18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"/></svg></span></a></li></ul></div><div class="copyright"><p>2025 <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" aria-label="CC BY-NC-ND 4.0 License" target="_blank" rel="noopener noreferrer nofollow license">CC BY-NC-ND 4.0</a> Jean-Jerome Levy for Scalastic unless otherwise specified</p></div></footer></aside><div class="content-box clearfix"><article class="article-page"><div class="page-content"><div class="page-cover-image"><figure><picture> <source sizes="(max-width : 769px) calc(100vw - 20px), (max-width : 1119px) calc(100vw - 20px), (min-width: 1120px) 970px" media="(max-width : 769px)" srcset="/assets/img/ufw-fail2ban-nginx-400-9ea680cff.avif 400w, /assets/img/ufw-fail2ban-nginx-970-9ea680cff.avif 970w, /assets/img/ufw-fail2ban-nginx-1365-9ea680cff.avif 1365w" type="image/avif"> <source sizes="(max-width : 769px) calc(100vw - 20px), (max-width : 1119px) calc(100vw - 20px), (min-width: 1120px) 970px" media="(max-width : 1119px)" srcset="/assets/img/ufw-fail2ban-nginx-400-91248b6f5.avif 400w, /assets/img/ufw-fail2ban-nginx-970-91248b6f5.avif 970w, /assets/img/ufw-fail2ban-nginx-1792-91248b6f5.avif 1792w" type="image/avif"> <source sizes="(max-width : 769px) calc(100vw - 20px), (max-width : 1119px) calc(100vw - 20px), (min-width: 1120px) 970px" srcset="/assets/img/ufw-fail2ban-nginx-400-91248b6f5.avif 400w, /assets/img/ufw-fail2ban-nginx-970-91248b6f5.avif 970w, /assets/img/ufw-fail2ban-nginx-1792-91248b6f5.avif 1792w" type="image/avif"> <source sizes="(max-width : 769px) calc(100vw - 20px), (max-width : 1119px) calc(100vw - 20px), (min-width: 1120px) 970px" media="(max-width : 769px)" srcset="/assets/img/ufw-fail2ban-nginx-400-33afdf642.jpg 400w, /assets/img/ufw-fail2ban-nginx-970-33afdf642.jpg 970w, /assets/img/ufw-fail2ban-nginx-1365-33afdf642.jpg 1365w" type="image/jpeg"> <source sizes="(max-width : 769px) calc(100vw - 20px), (max-width : 1119px) calc(100vw - 20px), (min-width: 1120px) 970px" media="(max-width : 1119px)" srcset="/assets/img/ufw-fail2ban-nginx-400-cdd8b487e.jpg 400w, /assets/img/ufw-fail2ban-nginx-970-cdd8b487e.jpg 970w, /assets/img/ufw-fail2ban-nginx-1792-cdd8b487e.jpg 1792w" type="image/jpeg"> <source sizes="(max-width : 769px) calc(100vw - 20px), (max-width : 1119px) calc(100vw - 20px), (min-width: 1120px) 970px" srcset="/assets/img/ufw-fail2ban-nginx-400-cdd8b487e.jpg 400w, /assets/img/ufw-fail2ban-nginx-970-cdd8b487e.jpg 970w, /assets/img/ufw-fail2ban-nginx-1792-cdd8b487e.jpg 1792w" type="image/jpeg"> <img class="page-image" width="1100" height="550" src="/assets/img/ufw-fail2ban-nginx-800-cdd8b487e.jpg" alt="Turn Your Nginx Server into a Fortress with Fail2ban and UFW"> </picture><figcaption>Illustration by <a href="#">DALL•E</a> on a <a href="https://www.fortnite.com/">Fortnite</a> theme</figcaption></figure></div><div class="wrap-content"><header class="page-header"><h1 class="page-title">Turn Your Nginx Server into a Fortress with Fail2ban and UFW</h1><div class="page-metadata"><ul><li><span><svg width="16.625" height="19" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"/></svg></span> December 23, 2023</li><li><span><svg width="19" height="19" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg></span> 56 minutes</li><li><span><svg width="23.75" height="19" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"/></svg></span></li><li><a class="tag" href="/en/tags#UFW" rel="tag">UFW</a></li><li><a class="tag" href="/en/tags#Fail2ban" rel="tag">Fail2ban</a></li><li><a class="tag" href="/en/tags#Nginx" rel="tag">Nginx</a></li><li><a class="tag" href="/en/tags#Security" rel="tag">Security</a></li><li><a class="tag" href="/en/tags#Cybersecurity" rel="tag">Cybersecurity</a></li><li><a class="tag" href="/en/tags#DevSecOps" rel="tag">DevSecOps</a></li></ul></div></header><p>In today’s digital world, web server security is not just an option, but an absolute necessity. In an era where cyber attacks are multiplying and constantly evolving, effectively protecting one’s online infrastructure has become paramount. This article focuses on securing a Nginx web server, a platform widely used for its reliability and performance.</p><p>We will address two essential tools in the arsenal of computer security: Fail2ban and UFW (Uncomplicated Firewall). Fail2ban is an intrusion prevention software that protects your server against unauthorized access attempts, often marked by multiple failed login attempts. On the other hand, UFW offers simplified firewall management, allowing easy control of incoming and outgoing traffic.</p><p>In this article, we will detail how these tools can be used together to enhance the security of your Nginx server. We will explore the steps of installation and configuration, guiding you through the process of setting up effective security rules.</p><hr class="hr-text" data-content="Summary" /><ul id="markdown-toc"><li><a href="#introduction-to-fail2ban-and-ufw" id="markdown-toc-introduction-to-fail2ban-and-ufw">Introduction to Fail2ban and UFW</a><ul><li><a href="#fail2ban-the-digital-bodyguard" id="markdown-toc-fail2ban-the-digital-bodyguard">Fail2ban: The Digital Bodyguard</a></li><li><a href="#ufw-a-simplified-firewall-approach" id="markdown-toc-ufw-a-simplified-firewall-approach">UFW: A Simplified Firewall Approach</a></li><li><a href="#essential-complementarity" id="markdown-toc-essential-complementarity">Essential Complementarity</a></li></ul></li><li><a href="#basic-installation-and-configuration" id="markdown-toc-basic-installation-and-configuration">Basic Installation and Configuration</a><ul><li><a href="#step-1-installing-ufw" id="markdown-toc-step-1-installing-ufw">Step 1: Installing UFW</a></li><li><a href="#step-2-installing-fail2ban" id="markdown-toc-step-2-installing-fail2ban">Step 2: Installing Fail2ban</a></li><li><a href="#step-3-understanding-how-fail2ban-works" id="markdown-toc-step-3-understanding-how-fail2ban-works">Step 3: Understanding How Fail2ban Works</a></li><li><a href="#step-4-configuring-fail2bans-basic-rules" id="markdown-toc-step-4-configuring-fail2bans-basic-rules">Step 4: Configuring Fail2ban’s Basic Rules</a></li></ul></li><li><a href="#advanced-configuration-of-ufw" id="markdown-toc-advanced-configuration-of-ufw">Advanced Configuration of UFW</a><ul><li><a href="#step-5-block-everything-and-open-only-whats-necessary" id="markdown-toc-step-5-block-everything-and-open-only-whats-necessary">Step 5: Block Everything and Open Only What’s Necessary</a></li><li><a href="#step-6-activating-the-rules" id="markdown-toc-step-6-activating-the-rules">Step 6: Activating the Rules</a></li><li><a href="#step-7-add-additional-rules-based-on-your-services" id="markdown-toc-step-7-add-additional-rules-based-on-your-services">Step 7: Add Additional Rules Based on Your Services</a></li></ul></li><li><a href="#advanced-configuration-of-fail2ban" id="markdown-toc-advanced-configuration-of-fail2ban">Advanced Configuration of Fail2ban</a><ul><li><a href="#step-8-list-preconfigured-filters-on-your-server" id="markdown-toc-step-8-list-preconfigured-filters-on-your-server">Step 8: List Preconfigured Filters on Your Server</a></li><li><a href="#step-9-add-jails-to-your-configuration" id="markdown-toc-step-9-add-jails-to-your-configuration">Step 9: Add Jails to Your Configuration</a></li><li><a href="#step-10-verification-and-testing" id="markdown-toc-step-10-verification-and-testing">Step 10: Verification and Testing</a></li></ul></li><li><a href="#visualization-and-analysis-of-bans" id="markdown-toc-visualization-and-analysis-of-bans">Visualization and Analysis of Bans</a><ul><li><a href="#data-extraction" id="markdown-toc-data-extraction">Data Extraction</a></li><li><a href="#calculating-some-statistics" id="markdown-toc-calculating-some-statistics">Calculating Some Statistics</a></li><li><a href="#scans-by-country" id="markdown-toc-scans-by-country">Scans by Country</a><ul><li><a href="#results" id="markdown-toc-results">Results</a></li><li><a href="#interpretation-of-blocked-scans-by-country" id="markdown-toc-interpretation-of-blocked-scans-by-country">Interpretation of Blocked Scans by Country</a></li></ul></li><li><a href="#scans-by-organization" id="markdown-toc-scans-by-organization">Scans by Organization</a><ul><li><a href="#results-1" id="markdown-toc-results-1">Results</a></li><li><a href="#interpretation-of-blocked-scans-by-organization" id="markdown-toc-interpretation-of-blocked-scans-by-organization">Interpretation of Blocked Scans by Organization</a></li></ul></li><li><a href="#scans-by-city" id="markdown-toc-scans-by-city">Scans by City</a><ul><li><a href="#results-2" id="markdown-toc-results-2">Results</a></li><li><a href="#interpretation-of-blocked-scans-statistics-by-city" id="markdown-toc-interpretation-of-blocked-scans-statistics-by-city">Interpretation of Blocked Scans Statistics by City</a></li></ul></li></ul></li><li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li></ul><hr class="hr-text" data-content="Defense Tools" /><h2 id="introduction-to-fail2ban-and-ufw">Introduction to Fail2ban and UFW</h2><h3 id="fail2ban-the-digital-bodyguard">Fail2ban: The Digital Bodyguard</h3><p>Fail2ban is an indispensable tool for server security. Its primary role is to monitor your server’s logs for signs of malicious activities, especially repeated unsuccessful login attempts. By detecting these attempts, often indicative of a brute-force attack, Fail2ban intervenes by temporarily banning the attacker’s IP address, thereby quarantining it to prevent future intrusions.</p><p>This software operates through “filters” defined by the user, which specify the conditions under which an IP address should be banned. These filters are associated with “actions”, such as modifying firewall rules to block traffic from the banned address. Thus, using Fail2ban is a proactive method to protect your server against common attacks, while remaining flexible enough to adapt to various threat scenarios.</p><h3 id="ufw-a-simplified-firewall-approach">UFW: A Simplified Firewall Approach</h3><p>UFW, standing for Uncomplicated Firewall, is an easy-to-use firewall for Linux-based operating systems. True to its name, UFW aims to simplify firewall management while offering robust protection. It serves as a user interface for iptables, the default firewall in Linux.</p><p>With UFW, you can easily set up rules that determine which traffic is allowed to enter or leave your server. These rules can be defined based on ports, protocols, and IP addresses. UFW also allows for the configuration of more complex rules if necessary, while maintaining a simple interface for less experienced users.</p><h3 id="essential-complementarity">Essential Complementarity</h3><p>The combination of Fail2ban and UFW provides a solid layer of security for your Nginx server. While Fail2ban focuses on preventing brute-force attacks by banning suspicious IPs, UFW manages overall inbound and outbound traffic, thus offering a barrier against a wide range of threats. By using these two tools together, you create a server environment that is not only resistant to the most common attacks but also adaptable to emerging threats.</p><hr class="hr-text" data-content="Installation" /><h2 id="basic-installation-and-configuration">Basic Installation and Configuration</h2><figure class="article"><picture> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-basic-installation-440-902300a27.avif 440w, /assets/img/ufw-fail2ban-nginx-basic-installation-950-902300a27.avif 950w" type="image/avif" /> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-basic-installation-440-f918e4fde.jpeg 440w, /assets/img/ufw-fail2ban-nginx-basic-installation-950-f918e4fde.jpeg 950w" type="image/jpeg" /> <img src="/assets/img/ufw-fail2ban-nginx-basic-installation-800-f918e4fde.jpeg" alt="Quite an interesting illustration of a server setup by DALL·E" width="950" height="543" /> </picture><figcaption>Quite an interesting illustration of a server setup by DALL·E</figcaption></figure><p>While the following instructions are specific to Ubuntu Linux distribution, the principles and commands are largely transferable to other Linux systems. With minor adaptations, these steps can be applied to various distributions, making this guide useful for a wide range of Linux users.</p><h3 id="step-1-installing-ufw">Step 1: Installing UFW</h3><ul><li><strong>1. Install UFW</strong>: To install UFW, run:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>apt-get update
<span class="nb">sudo </span>apt-get <span class="nb">install </span>ufw</code></pre></figure><div class="code-label"> Shell</div></div></div><h3 id="step-2-installing-fail2ban">Step 2: Installing Fail2ban</h3><ul><li><strong>1. Install Fail2ban</strong>: Execute the following commands to install Fail2ban on your Ubuntu server:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>apt-get update
<span class="nb">sudo </span>apt-get <span class="nb">install </span>fail2ban</code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li><strong>2. Activate the Fail2ban service</strong>: To start the service and enable it automatically at system startup, run the following commands:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>systemctl start fail2ban
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>fail2ban</code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li><strong>3. Verify the installation</strong>: To ensure that the service has started and is functioning correctly, launch:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>systemctl status fail2ban</code></pre></figure><div class="code-label"> Shell</div></div></div><p>You should see:</p><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-output" data-lang="output">● fail2ban.service - Fail2Ban Service
Loaded: loaded (/lib/systemd/system/fail2ban.service; enabled; vendor preset: enabled)
Active: active (running) since Fri 2023-12-22 00:16:31 CET; 1 day 9h ago
Docs: man:fail2ban(1)
Main PID: 601234 (fail2ban-server)
Tasks: 19 (limit: 11829)
Memory: 39.8M
CPU: 2h 43min 80ms
CGroup: /system.slice/fail2ban.service
└─601234 /usr/bin/python3 /usr/bin/fail2ban-server -xf start

Dec 22 00:16:31 myserver systemd[1]: Started Fail2Ban Service.
Dec 22 00:16:32 myserver fail2ban-server[601234]: Server ready</code></pre></figure><div class="code-label"> Output</div></div></div><h3 id="step-3-understanding-how-fail2ban-works">Step 3: Understanding How Fail2ban Works</h3><p>Before delving into configuration, it is crucial to understand how Fail2ban operates. This software relies on three main components located in different directories: jails, filters, and actions.</p><ul><li><p><strong>1. Jails</strong>: These are sets of rules defining when and how an IP address should be banned. A jail is defined by log files to monitor, using <strong>filters</strong> (in the form of regex), and triggers <strong>actions</strong> when failures are detected (the filters return a result).</p><p>Fail2ban includes predefined jail configurations in <code class="language-plaintext highlighter-rouge">/etc/fail2ban/jail.conf</code>.</p></li><li><p><strong>2. Filters</strong>: They are used to analyze service logs via regex to detect suspicious behavior, such as intrusion attempts.</p><p>They are found in <code class="language-plaintext highlighter-rouge">/etc/fail2ban/filter.d/</code>.</p></li><li><p><strong>3. Actions</strong>: These can include banning an IP address, sending notifications, or executing custom scripts.</p><p>The <strong>actions</strong>, defining commands to ban or unban an IP address, are located in <code class="language-plaintext highlighter-rouge">/etc/fail2ban/action.d/</code>.</p></li></ul><h3 id="step-4-configuring-fail2bans-basic-rules">Step 4: Configuring Fail2ban’s Basic Rules</h3><div class="premonition info"> <i class="premonition pn-info"></i><div class="content"><p class="header">Warning</p><p>Do not directly modify the files <code class="language-plaintext highlighter-rouge">/etc/fail2ban/fail2ban.conf</code> and <code class="language-plaintext highlighter-rouge">/etc/fail2ban/jail.conf</code>: these files, containing fail2ban’s default configurations, can be reset during system updates.</p></div></div><ul><li><strong>1. Create a dedicated configuration file</strong>: To do this, open your favorite editor, here nano, by executing the command:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>nano /etc/fail2ban/jail.d/custom.conf</code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li><strong>2. Override the base configurations</strong>: All default parameters and configurations are found in the file <code class="language-plaintext highlighter-rouge">/etc/fail2ban/jail.conf</code>. Here is a list of important parameters to override and adapt according to the behavior you desire:<ul><li><strong>bantime</strong>: Defines the duration of an IP ban (default 10 minutes, recommended several hours or days).</li><li><strong>findtime</strong>: Period during which anomalies are searched for in the logs.</li><li><strong>ignoreip</strong>: List of IPs to ignore, including yours to avoid self-banning.</li><li><strong>maxretry</strong>: Number of failed attempts allowed before banning.</li></ul><p>Also define the use of UFW to take control of the banning (<code class="language-plaintext highlighter-rouge">banaction</code> and <code class="language-plaintext highlighter-rouge">banaction_allports</code>).</p><p>Here is an example of a drastic configuration, banning any first intrusion attempt for 1 day. We also define the use of UFW, (note the local IP addresses that you may need to adjust according to your local network configuration):</p></li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-conf" data-lang="conf">[<span class="n">DEFAULT</span>]
<span class="n">bantime</span> = <span class="m">1</span><span class="n">d</span>
<span class="n">findtime</span> = <span class="m">1</span><span class="n">d</span>
<span class="n">ignoreip</span> = <span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>/<span class="m">8</span> <span class="m">192</span>.<span class="m">168</span>.<span class="m">0</span>.<span class="m">0</span>/<span class="m">16</span>
<span class="n">maxretry</span> = <span class="m">1</span>

<span class="n">banaction</span> = <span class="n">ufw</span>
<span class="n">banaction_allports</span> = <span class="n">ufw</span></code></pre></figure><div class="code-label"> Conf</div></div></div><ul><li><strong>3. Restart the Fail2ban service</strong>: To apply your modifications, restart the Fail2ban service by launching the command:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>systemctl restart fail2ban</code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li><strong>4. Verify the service status</strong>:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>fail2ban-client status</code></pre></figure><div class="code-label"> Shell</div></div></div><p>Which should give you:</p><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-output" data-lang="output">$ sudo fail2ban-client status
Status
|- Number of jail:	1
`- Jail list:	sshd</code></pre></figure><div class="code-label"> Output</div></div></div><hr class="hr-text" data-content="UFW Configuration" /><h2 id="advanced-configuration-of-ufw">Advanced Configuration of UFW</h2><figure class="article"><picture> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-ufw-config-440-c3cc0d15b.avif 440w, /assets/img/ufw-fail2ban-nginx-ufw-config-950-c3cc0d15b.avif 950w" type="image/avif" /> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-ufw-config-440-ebcf035d3.jpeg 440w, /assets/img/ufw-fail2ban-nginx-ufw-config-950-ebcf035d3.jpeg 950w" type="image/jpeg" /> <img src="/assets/img/ufw-fail2ban-nginx-ufw-config-800-ebcf035d3.jpeg" alt="Allegorical or even wacky illustration of UFW by DALL·E" width="950" height="543" /> </picture><figcaption>Allegorical or even wacky illustration of UFW by DALL·E</figcaption></figure><p>We will apply the principle of least privilege by defaulting to blocking all incoming and outgoing connections, and only allowing the necessary traffic for specific services. By following this principle, we minimize the risks associated with unauthorized access or exploitation of vulnerabilities, ensuring that only essential ports and services are accessible.</p><p>Let’s see how to configure the firewall rules with UFW:</p><h3 id="step-5-block-everything-and-open-only-whats-necessary">Step 5: Block Everything and Open Only What’s Necessary</h3><ul><li><strong>Setting default rules</strong>: Block all incoming and outgoing connections by default:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>ufw default deny incoming
<span class="nb">sudo </span>ufw default deny outgoing</code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li><p><strong>Authorizing necessary connections</strong>: Open HTTP and HTTPS ports in both directions, SSH, and outgoing DNS:</p><ul><li>Allow incoming connections for the web (HTTP and HTTPS):</li></ul></li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>ufw allow <span class="k">in </span>80/tcp
<span class="nb">sudo </span>ufw allow <span class="k">in </span>443/tcp</code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li>Allow outgoing connections for the web:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>ufw allow out 80/tcp
<span class="nb">sudo </span>ufw allow out 443/tcp</code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li>Allow SSH connections (for remote management):</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>ufw allow <span class="k">in </span>22/tcp</code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li>Allow outgoing DNS connections (for domain name resolution):</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>ufw allow out 53/udp</code></pre></figure><div class="code-label"> Shell</div></div></div><h3 id="step-6-activating-the-rules">Step 6: Activating the Rules</h3><ul><li><strong>Activating the UFW firewall</strong>: Enable UFW with:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>ufw <span class="nb">enable</span></code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li><strong>Checking the configured rules</strong>: Recheck the status and rules of the firewall with:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>ufw status verbose</code></pre></figure><div class="code-label"> Shell</div></div></div><h3 id="step-7-add-additional-rules-based-on-your-services">Step 7: Add Additional Rules Based on Your Services</h3><ul><li><strong>Mail</strong>: Allow outgoing SMTP connections for sending emails:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>ufw allow out 25/tcp</code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li><p><strong>Additional Security (optional)</strong>:</p><ul><li>Limit SSH connection attempts to enhance security:</li></ul></li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>ufw limit 22/tcp comment <span class="s1">'Allow 6 connections over 30 seconds'</span></code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li>Restrict SSH access to certain IP addresses:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>ufw delete allow <span class="k">in </span>22/tcp
<span class="nb">sudo </span>ufw allow from 192.168.0.0/16 to any port 22 proto tcp</code></pre></figure><div class="code-label"> Shell</div></div></div><hr class="hr-text" data-content="Fail2ban Configuration" /><h2 id="advanced-configuration-of-fail2ban">Advanced Configuration of Fail2ban</h2><figure class="article"><picture> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-fail2ban-config-440-12ed1e0ca.avif 440w, /assets/img/ufw-fail2ban-nginx-fail2ban-config-950-12ed1e0ca.avif 950w" type="image/avif" /> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-fail2ban-config-440-abad986f6.jpeg 440w, /assets/img/ufw-fail2ban-nginx-fail2ban-config-950-abad986f6.jpeg 950w" type="image/jpeg" /> <img src="/assets/img/ufw-fail2ban-nginx-fail2ban-config-800-abad986f6.jpeg" alt="Amphetamine-fueled illustration of Fail2ban by DALL·E" width="950" height="543" /> </picture><figcaption>Amphetamine-fueled illustration of Fail2ban by DALL·E</figcaption></figure><h3 id="step-8-list-preconfigured-filters-on-your-server">Step 8: List Preconfigured Filters on Your Server</h3><ul><li><strong>Nginx Filters</strong>: List existing filters (may differ on your server):</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-output" data-lang="output">$ sudo ls -alt /etc/fail2ban/filter.d/nginx*

-rw-r--r-- 1 root root  327 Nov 23  2020 /etc/fail2ban/filter.d/nginx-sslerror.conf
-rw-r--r-- 1 root root  232 Nov 23  2020 /etc/fail2ban/filter.d/nginx-4xx.conf
-rw-r--r-- 1 root root  564 Nov 23  2020 /etc/fail2ban/filter.d/nginx-forbidden.conf
-rw-r--r-- 1 root root  681 Nov 23  2020 /etc/fail2ban/filter.d/nginx-botsearch.conf
-rw-r--r-- 1 root root  485 Nov 23  2020 /etc/fail2ban/filter.d/nginx-http-auth.conf
-rw-r--r-- 1 root root 1454 Nov 23  2020 /etc/fail2ban/filter.d/nginx-limit-req.conf</code></pre></figure><div class="code-label"> Output</div></div></div><ul><li><p><strong>Create Filters</strong>: Create filters that do not exist on your server. For this, enter the commands:</p><ul><li>For the <code class="language-plaintext highlighter-rouge">nginx-sslerror.conf</code> filter: This filter protects against SSL handshake failure attacks, where an attacker tries to negotiate an SSL/TLS connection with incorrect or malicious parameters.</li></ul></li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>bash <span class="nt">-c</span> <span class="s1">'cat &gt; /etc/fail2ban/filter.d/nginx-sslerror.conf &lt;&lt;EOF
[Definition]
failregex = SSL_do_handshake\(\) failed .+ while SSL handshaking, client: &lt;HOST&gt;, server: .+

ignoreregex =

datepattern = {^LN-BEG}%%ExY(?P&lt;_sep&gt;[-/.])%%m(?P=_sep)%%d[T ]%%H:%%M:%%S(?:[.,]%%f)?(?:\s*%%z)?
^[^\[]*\[({DATE})
{^LN-BEG}
EOF'</span></code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li>For the <code class="language-plaintext highlighter-rouge">nginx-4xx.conf</code> filter: This filter detects requests generating HTTP 4xx errors (like 404, 403, 400), often the result of attempts to access unauthorized or non-existent resources, indicating malicious probing.</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>bash <span class="nt">-c</span> <span class="s1">'cat &gt; /etc/fail2ban/filter.d/nginx-4xx.conf &lt;&lt;EOF
[Definition]
failregex = ^&lt;HOST&gt;.*"(GET|POST).*" (404|444|403|400) .*$

ignoreregex = .*(robots.txt|favicon.ico|jpg|png)
EOF'</span></code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li>For the <code class="language-plaintext highlighter-rouge">nginx-forbidden.conf</code> filter: This filter targets attempts to access forbidden directories. It is useful for blocking directory scans attempting to discover hidden files or folders on the server.</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>bash <span class="nt">-c</span> <span class="s1">'cat &gt; /etc/fail2ban/filter.d/nginx-forbidden.conf &lt;&lt;EOF
[Definition]
failregex = directory index of .+ is forbidden, client: &lt;HOST&gt;, server: .+
ignoreregex =

EOF'</span></code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li>For the <code class="language-plaintext highlighter-rouge">nginx-botsearch.conf</code> filter: This filter focuses on requests for URLs that do not exist (404 errors), often a sign of a bot or scanner trying to find vulnerabilities or hidden pages.</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>bash <span class="nt">-c</span> <span class="s1">'cat &gt; /etc/fail2ban/filter.d/nginx-botsearch.conf &lt;&lt;EOF
# Fail2Ban filter to match web requests for selected URLs that don'</span>t exist
<span class="c">#</span>

<span class="o">[</span>INCLUDES]

<span class="c"># Load regexes for filtering</span>
before <span class="o">=</span> botsearch-common.conf

<span class="o">[</span>Definition]

failregex <span class="o">=</span> ^&lt;HOST&gt; <span class="se">\-</span> <span class="se">\S</span>+ <span class="se">\[\]</span> <span class="se">\"</span><span class="o">(</span>GET|POST|HEAD<span class="o">)</span> <span class="se">\/</span>&lt;block&gt; <span class="se">\S</span>+<span class="se">\"</span> 404 .+<span class="err">$</span>
^ <span class="se">\[</span>error<span class="se">\]</span> <span class="se">\d</span>+#<span class="se">\d</span>+: <span class="se">\*\d</span>+ <span class="o">(</span><span class="se">\S</span>+ <span class="o">)</span>?<span class="se">\"\S</span>+<span class="se">\"</span> <span class="o">(</span>failed|is not found<span class="o">)</span> <span class="se">\(</span>2<span class="se">\:</span> No such file or directory<span class="se">\)</span>, client<span class="se">\:</span> &lt;HOST&gt;<span class="se">\,</span> server<span class="se">\:</span> <span class="se">\S</span><span class="k">*</span><span class="se">\,</span> request: <span class="se">\"</span><span class="o">(</span>GET|POST|HEAD<span class="o">)</span> <span class="se">\/</span>&lt;block&gt; <span class="se">\S</span>+<span class="se">\"\,</span> .<span class="k">*</span>?<span class="err">$</span>

ignoreregex <span class="o">=</span>

datepattern <span class="o">=</span> <span class="o">{</span>^LN-BEG<span class="o">}</span>%%ExY<span class="o">(</span>?P&lt;_sep&gt;[-/.]<span class="o">)</span>%%m<span class="o">(</span>?P<span class="o">=</span>_sep<span class="o">)</span>%%d[T <span class="o">]</span>%%H:%%M:%%S<span class="o">(</span>?:[.,]%%f<span class="o">)</span>?<span class="o">(</span>?:<span class="se">\s</span><span class="k">*</span>%%z<span class="o">)</span>?
^[^<span class="se">\[</span><span class="o">]</span><span class="k">*</span><span class="se">\[</span><span class="o">({</span>DATE<span class="o">})</span>
<span class="o">{</span>^LN-BEG<span class="o">}</span>

<span class="c"># DEV Notes:</span>
<span class="c"># Based on apache-botsearch filter</span>
<span class="c"># </span>
<span class="c"># Author: Frantisek Sumsal</span>
EOF<span class="s1">'</span></code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li>For the <code class="language-plaintext highlighter-rouge">nginx-http-auth.conf</code> filter: This filter is used to detect and block repeated failed authentication attempts, indicating a possible brute-force attack on password-protected areas.</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>bash <span class="nt">-c</span> <span class="s1">'cat &gt; /etc/fail2ban/filter.d/nginx-http-auth.conf &lt;&lt;EOF
# fail2ban filter configuration for nginx


[Definition]


failregex = ^ \[error\] \d+#\d+: \*\d+ user "(?:[^"]+|.*?)":? (password mismatch|was not found in "[^\"]*"), client: &lt;HOST&gt;, server: \S*, request: "\S+ \S+ HTTP/\d+\.\d+", host: "\S+"(?:, referrer: "\S+")?\s*$

ignoreregex =

datepattern = {^LN-BEG}

# DEV NOTES:
# Based on samples in https://github.com/fail2ban/fail2ban/pull/43/files
# Extensive search of all nginx auth failures not done yet.
# 
# Author: Daniel Black
EOF'</span></code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li>For the <code class="language-plaintext highlighter-rouge">nginx-limit-req.conf</code> filter: This filter aims to block IP addresses that exceed the request limits defined in Nginx (limit_req), typical of a distributed denial of service (DDoS) attack or aggressive bot behavior.</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>bash <span class="nt">-c</span> <span class="s1">'cat &gt; /etc/fail2ban/filter.d/nginx-limit-req.conf &lt;&lt;EOF
# Fail2ban filter configuration for nginx :: limit_req
# used to ban hosts, that were failed through nginx by limit request processing rate
#
# Author: Serg G. Brester (sebres)
#
# To use '</span>nginx-limit-req<span class="s1">' filter you should have `ngx_http_limit_req_module`
# and define `limit_req` and `limit_req_zone` as described in nginx documentation
# http://nginx.org/en/docs/http/ngx_http_limit_req_module.html
#
# Example:
#
#   http {
#     ...
#     limit_req_zone $binary_remote_addr zone=lr_zone:10m rate=1r/s;
#     ...
#     # http, server, or location:
#     location ... {
#       limit_req zone=lr_zone burst=1 nodelay;
#       ...
#     }
#     ...
#   }
#   ...
#

[Definition]

# Specify following expression to define exact zones, if you want to ban IPs limited
# from specified zones only.
# Example:
#
#   ngx_limit_req_zones = lr_zone|lr_zone2
#
ngx_limit_req_zones = [^"]+

# Use following full expression if you should range limit request to specified
# servers, requests, referrers etc. only :
#
# failregex = ^\s*\[[a-z]+\] \d+#\d+: \*\d+ limiting requests, excess: [\d\.]+ by zone "(?:%(ngx_limit_req_zones)s)", client: &lt;HOST&gt;, server: \S*, request: "\S+ \S+ HTTP/\d+\.\d+", host: "\S+"(, referrer: "\S+")?\s*$

# Shortly, much faster and stable version of regexp:
failregex = ^\s*\[[a-z]+\] \d+#\d+: \*\d+ limiting requests, excess: [\d\.]+ by zone "(?:%(ngx_limit_req_zones)s)", client: &lt;HOST&gt;,

ignoreregex =

datepattern = {^LN-BEG}
EOF'</span></code></pre></figure><div class="code-label"> Shell</div></div></div><h3 id="step-9-add-jails-to-your-configuration">Step 9: Add Jails to Your Configuration</h3><p>To add these jails to the Fail2Ban configuration in the <code class="language-plaintext highlighter-rouge">custom.conf</code> file, follow these steps:</p><ul><li><strong>Open the configuration file</strong>: Use the command to open the file in a text editor:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>nano /etc/fail2ban/jail.d/custom.conf</code></pre></figure><div class="code-label"> Shell</div></div></div><ul><li><strong>Add jail configurations</strong>: Copy and paste the following configurations at the end of the file:</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-conf" data-lang="conf">[<span class="n">sshd</span>]
<span class="n">enabled</span> = <span class="n">true</span>

[<span class="n">nginx</span>-<span class="m">4</span><span class="n">xx</span>]
<span class="n">enabled</span> = <span class="n">true</span>
<span class="n">port</span>     = <span class="n">http</span>,<span class="n">https</span>
<span class="n">filter</span>   = <span class="n">nginx</span>-<span class="m">4</span><span class="n">xx</span>
<span class="n">logpath</span>  = %(<span class="n">nginx_error_log</span>)<span class="n">s</span>

[<span class="n">nginx</span>-<span class="n">http</span>-<span class="n">auth</span>]
<span class="n">enabled</span> = <span class="n">true</span>
<span class="n">port</span>     = <span class="n">http</span>,<span class="n">https</span>
<span class="n">filter</span>   = <span class="n">nginx</span>-<span class="n">http</span>-<span class="n">auth</span>
<span class="n">logpath</span>  = %(<span class="n">nginx_error_log</span>)<span class="n">s</span>

[<span class="n">nginx</span>-<span class="n">botsearch</span>]
<span class="n">enabled</span> = <span class="n">true</span>
<span class="n">port</span>     = <span class="n">http</span>,<span class="n">https</span>
<span class="n">filter</span>   = <span class="n">nginx</span>-<span class="n">botsearch</span>
<span class="n">logpath</span>  = %(<span class="n">nginx_access_log</span>)<span class="n">s</span>

[<span class="n">nginx</span>-<span class="n">forbidden</span>]
<span class="n">enabled</span> = <span class="n">true</span>
<span class="n">port</span>    = <span class="n">http</span>,<span class="n">https</span>
<span class="n">filter</span>  = <span class="n">nginx</span>-<span class="n">forbidden</span>
<span class="n">logpath</span> = %(<span class="n">nginx_error_log</span>)<span class="n">s</span>

[<span class="n">nginx</span>-<span class="n">sslerror</span>]
<span class="n">enabled</span> = <span class="n">true</span>
<span class="n">port</span>    = <span class="n">http</span>,<span class="n">https</span>
<span class="n">filter</span>  = <span class="n">nginx</span>-<span class="n">sslerror</span>
<span class="n">logpath</span> = %(<span class="n">nginx_error_log</span>)<span class="n">s</span>

[<span class="n">ufw</span>]
<span class="n">enabled</span> = <span class="n">true</span>
<span class="n">filter</span>  = <span class="n">ufw</span>
<span class="n">logpath</span> = /<span class="n">var</span>/<span class="n">log</span>/<span class="n">ufw</span>.<span class="n">log</span></code></pre></figure><div class="code-label"> Conf</div></div></div><ul><li><p><strong>Save and close the file</strong>: After adding the configurations, save the file and close the text editor.</p></li><li><p><strong>Restart Fail2Ban</strong>: To apply the changes, restart Fail2Ban with:</p></li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>systemctl restart fail2ban</code></pre></figure><div class="code-label"> Shell</div></div></div><p>This configuration will add and activate the specified jails for SSH, various Nginx configurations, and UFW.</p><h3 id="step-10-verification-and-testing">Step 10: Verification and Testing</h3><p>After configuring, it is essential to test and verify that everything is working correctly.</p><ul><li><strong>Checking Fail2ban</strong>: Use this command to list the active jails and check that Fail2ban is functioning properly.</li></ul><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>fail2ban-client status</code></pre></figure><div class="code-label"> Shell</div></div></div><p>Which returns:</p><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-output" data-lang="output">$ sudo fail2ban-client status

Status
|- Number of jail:	7
`- Jail list:	nginx-4xx, nginx-botsearch, nginx-forbidden, nginx-http-auth, nginx-sslerror, sshd, ufw</code></pre></figure><div class="code-label"> Output</div></div></div><p>These steps form the basis for securing your Nginx server on Linux with Fail2ban and UFW. Remember that the configuration can be customized according to the specific needs of your server and network.</p><p>You will find multiple filters for Fail2ban on the internet, tailored to the services running on your server.</p><hr class="hr-text" data-content="Statistics" /><h2 id="visualization-and-analysis-of-bans">Visualization and Analysis of Bans</h2><figure class="article"><picture> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-fail2ban-visualization-440-c943fd0d8.avif 440w, /assets/img/ufw-fail2ban-nginx-fail2ban-visualization-950-c943fd0d8.avif 950w" type="image/avif" /> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-fail2ban-visualization-440-4dc31d0c8.jpeg 440w, /assets/img/ufw-fail2ban-nginx-fail2ban-visualization-950-4dc31d0c8.jpeg 950w" type="image/jpeg" /> <img src="/assets/img/ufw-fail2ban-nginx-fail2ban-visualization-800-4dc31d0c8.jpeg" alt="Surprisingly wise illustration of 'visualization and analysis' by DALL·E" width="950" height="543" /> </picture><figcaption>Surprisingly wise illustration of 'visualization and analysis' by DALL·E</figcaption></figure><h3 id="data-extraction">Data Extraction</h3><p>To effectively understand and analyze Fail2Ban’s security actions, it’s useful to have an overview of the banned IP addresses.</p><p>The following script provides this visibility, categorized by jail:</p><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="k">for </span>jail <span class="k">in</span> <span class="si">$(</span><span class="nb">sudo </span>fail2ban-client status | <span class="nb">grep</span> <span class="s1">'Jail list:'</span> | <span class="nb">sed</span> <span class="s1">'s/.*://;s/,//g'</span><span class="si">)</span><span class="p">;</span> <span class="k">do
  </span><span class="nb">echo</span> <span class="s2">"Jail: </span><span class="nv">$jail</span><span class="s2">"</span><span class="p">;</span>
  <span class="nb">sudo </span>fail2ban-client status <span class="nv">$jail</span> | <span class="nb">grep</span> <span class="s1">'Banned IP'</span><span class="p">;</span>
<span class="k">done</span></code></pre></figure><div class="code-label"> Shell</div></div></div><p>Here is an example of all the IPs that have been blocked on my server:</p><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-output" data-lang="output">Jail: nginx-4xx
`- Banned IP list:
Jail: nginx-botsearch
`- Banned IP list:	199.229.240.163
Jail: nginx-forbidden
`- Banned IP list:	104.199.31.214 146.190.242.134 152.32.211.69 159.203.88.161...
Jail: nginx-http-auth
`- Banned IP list:
Jail: nginx-sslerror
`- Banned IP list:	107.170.208.31 167.248.133.182 212.102.40.218
Jail: sshd
`- Banned IP list:	101.34.23.155 101.43.39.167 103.144.3.14 103.39.209.130 103...
Jail: ufw
`- Banned IP list:	192.241.233.7 1.12.249.176 1.12.73.13 1.21.202.235 1.34.233...</code></pre></figure><div class="code-label"> Output</div></div></div><p>I truncated the IPs, there were more than 2600 for 24 hours of retention! This example shows that a very large number of IP addresses were blocked on my server, which does not contain highly sensitive data.</p><p>The significant volume of banned IPs also highlights the extent and consistency of automated attacks against online servers. Even systems that seem uninteresting are frequently targeted by bots and cyber attackers seeking vulnerabilities, for malicious purposes such as spam or botnet creation. There are also many legitimate companies scanning the internet for compromised servers.</p><h3 id="calculating-some-statistics">Calculating Some Statistics</h3><p>The analysis of IP data can reveal significant information about the geographical distribution, organizational ownership, and location of these scans.</p><p>The Bash script below allows for precise statistics to be calculated from the collected IP addresses. These statistics include the counting of the number of IP addresses by country, organization, and city. This process helps understand the trends of attacks and their geographic distribution.</p><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>

<span class="c"># Replace this with your personal API key to the free service https://ipinfo.io</span>
<span class="nv">API_KEY</span><span class="o">=</span><span class="s2">"your_api_key_here"</span>

<span class="c"># Name of the file containing IP addresses (one per line)</span>
<span class="nv">FILE</span><span class="o">=</span><span class="s2">"ip_list.txt"</span>

<span class="c"># Files for storing counts</span>
<span class="nv">COUNTRY_FILE</span><span class="o">=</span><span class="s2">"country_count.txt"</span>
<span class="nv">ORG_FILE</span><span class="o">=</span><span class="s2">"org_count.txt"</span>
<span class="nv">CITY_FILE</span><span class="o">=</span><span class="s2">"city_count.txt"</span>

<span class="c"># Initialize counting files if they do not exist</span>
<span class="o">&gt;</span> <span class="s2">"</span><span class="nv">$COUNTRY_FILE</span><span class="s2">"</span>
<span class="o">&gt;</span> <span class="s2">"</span><span class="nv">$ORG_FILE</span><span class="s2">"</span>
<span class="o">&gt;</span> <span class="s2">"</span><span class="nv">$CITY_FILE</span><span class="s2">"</span>

<span class="c"># Function to obtain geolocation information of an IP address</span>
get_ip_info<span class="o">()</span> <span class="o">{</span>
  <span class="nb">local </span><span class="nv">ip</span><span class="o">=</span><span class="nv">$1</span>
  curl <span class="nt">-s</span> <span class="s2">"https://ipinfo.io/</span><span class="nv">$ip</span><span class="s2">?token=</span><span class="nv">$API_KEY</span><span class="s2">"</span>
<span class="o">}</span>

<span class="c"># Check if the file exists</span>
<span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$FILE</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"File </span><span class="nv">$FILE</span><span class="s2"> not found."</span>
  <span class="nb">exit </span>1
<span class="k">fi</span>

<span class="c"># Iterate over each line in the file</span>
<span class="k">while </span><span class="nv">IFS</span><span class="o">=</span> <span class="nb">read</span> <span class="nt">-r</span> ip
<span class="k">do
  </span><span class="nb">echo</span> <span class="s2">"Processing </span><span class="k">${</span><span class="nv">ip</span><span class="k">}</span><span class="s2">..."</span>
  <span class="nv">ip_info</span><span class="o">=</span><span class="si">$(</span>get_ip_info <span class="s2">"</span><span class="nv">$ip</span><span class="s2">"</span><span class="si">)</span>
  <span class="nv">country</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$ip_info</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="s1">'.country'</span><span class="si">)</span>
  <span class="nv">org</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$ip_info</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="s1">'.org'</span><span class="si">)</span>
  <span class="nv">city</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$ip_info</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="s1">'.city'</span><span class="si">)</span>
  
  <span class="c"># Update counting files</span>
  <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$country</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> <span class="s2">"</span><span class="nv">$COUNTRY_FILE</span><span class="s2">"</span>
  <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$org</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> <span class="s2">"</span><span class="nv">$ORG_FILE</span><span class="s2">"</span>
  <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$city</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> <span class="s2">"</span><span class="nv">$CITY_FILE</span><span class="s2">"</span>
<span class="k">done</span> &lt; <span class="s2">"</span><span class="nv">$FILE</span><span class="s2">"</span>

<span class="c"># Function to count occurrences</span>
count_occurrences<span class="o">()</span> <span class="o">{</span>
  <span class="nb">sort</span> <span class="nt">-bfg</span> | <span class="nb">uniq</span> <span class="nt">-c</span>
<span class="o">}</span>

<span class="c"># Function to sort occurrences</span>
sort_occurrences<span class="o">()</span> <span class="o">{</span>
  <span class="nb">sort</span> <span class="nt">-rn</span> <span class="nt">-k1</span>,1
<span class="o">}</span>

<span class="c"># Display statistics</span>
<span class="nb">echo</span> <span class="s2">"Statistics by country code:"</span>
<span class="nb">cat</span> <span class="s2">"</span><span class="nv">$COUNTRY_FILE</span><span class="s2">"</span> | count_occurrences | sort_occurrences

<span class="nb">echo</span> <span class="s2">"Statistics by organization:"</span>
<span class="nb">cat</span> <span class="s2">"</span><span class="nv">$ORG_FILE</span><span class="s2">"</span> | count_occurrences | sort_occurrences

<span class="nb">echo</span> <span class="s2">"Statistics by city:"</span>
<span class="nb">cat</span> <span class="s2">"</span><span class="nv">$CITY_FILE</span><span class="s2">"</span> | count_occurrences | sort_occurrences</code></pre></figure><div class="code-label"> Bash</div></div></div><h3 id="scans-by-country">Scans by Country</h3><h4 id="results">Results</h4><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-output" data-lang="output">1055 US
361 CN
252 GB
135 NL
98 DE
71 BR
69 TW
57 KR
53 IN
45 BE
44 RU
43 FR
40 JP
25 VN
24 HK
21 SG
20 IT
19 CA
16 BG
13 TR
13 TH
13 SE
13 ID
13 AU
11 AR
9 PL
7 UA
7 PH
7 LT
7 IR
5 IL
4 MX
4 CL
3 VE
3 RO
3 NG
3 IQ
3 CZ
2 GR
2 ES
2 CO
2 CH
2 BD
2 AT
2 AE
1 ZA
1 SK
1 SA
1 PK
1 PE
1 PA
1 NO
1 MY
1 MG
1 MA
1 LU
1 KZ
1 GU
1 DK
1 CV
1 CR
1 BZ
1 BY
1 BO
1 AZ</code></pre></figure><div class="code-label"> Output</div></div></div><h4 id="interpretation-of-blocked-scans-by-country">Interpretation of Blocked Scans by Country</h4><figure class="article"><picture> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-top-scans-by-country-440-665a2ace0.avif 440w, /assets/img/ufw-fail2ban-nginx-top-scans-by-country-950-665a2ace0.avif 950w" type="image/avif" /> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-top-scans-by-country-440-68ec5f0b2.jpeg 440w, /assets/img/ufw-fail2ban-nginx-top-scans-by-country-950-68ec5f0b2.jpeg 950w" type="image/jpeg" /> <img src="/assets/img/ufw-fail2ban-nginx-top-scans-by-country-800-68ec5f0b2.jpeg" alt="Top 20 countries with the highest number of scans" width="950" height="566" /> </picture><figcaption>Top 20 Countries with the highest number of scans</figcaption></figure><ul><li><strong>1. High Scanning Activity in the United States (US)</strong><ul><li><strong>Number of occurrences</strong>: 1055</li><li><strong>Implication</strong>: This high activity suggests a significant presence of scans, possibly automated, originating from the United States. This could indicate either a large number of active servers and computer systems or the presence of compromised networks.</li></ul></li><li><strong>2. Notable Presence of China (CN) and the United Kingdom (GB)</strong><ul><li><strong>China</strong>: 361 occurrences</li><li><strong>United Kingdom</strong>: 252 occurrences</li><li><strong>Implication</strong>: High frequency of scans from these regions, possibly indicating malicious activities or strong cyber defense.</li></ul></li><li><strong>3. Scans Originating from Europe</strong><ul><li><strong>Countries involved</strong>: Netherlands, Germany, Belgium, France, Russia</li><li><strong>Implication</strong>: Active scanning activities or networks often targeted by attacks, necessitating proactive defense.</li></ul></li><li><strong>4. Diversity of Asian Sources</strong><ul><li><strong>Countries involved</strong>: Taiwan, South Korea, India, Japan, Vietnam</li><li><strong>Implication</strong>: Regions active in scanning or targeted by attacks, reflecting the trends in cyber security in Asia.</li></ul></li><li><strong>5. Activity in Latin America and Africa</strong><ul><li><strong>Latin America</strong>: Brazil, Argentina, Mexico, Colombia</li><li><strong>Africa</strong>: Less prevalent but notable presence</li><li><strong>Implication</strong>: Trend towards the automation of attacks or the presence of compromised systems in these regions.</li></ul></li><li><strong>6. Countries with Few Occurrences</strong><ul><li><strong>Examples</strong>: African countries, European and Asian countries with a single or very few counts</li><li><strong>Implication</strong>: Sporadic scanning attempts or isolated actors.</li></ul></li></ul><p>These statistics provide an insight into trends in cyber security and malicious activities on the Internet. They reveal the effectiveness of security measures like Fail2Ban and UFW in protecting a server from unauthorized or malicious access attempts.</p><h3 id="scans-by-organization">Scans by Organization</h3><h4 id="results-1">Results</h4><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-output" data-lang="output">590 AS396982 Google LLC
384 AS14061 DigitalOcean, LLC
165 AS6939 Hurricane Electric LLC
108 AS4134 CHINANET-BACKBONE
98 AS398324 Censys, Inc.
71 AS37963 Hangzhou Alibaba Advertising Co.,Ltd.
59 AS45090 Shenzhen Tencent Computer Systems Company Limited
54 AS4837 CHINA UNICOM China169 Backbone
47 AS398705 Censys, Inc.
46 AS135377 UCLOUD INFORMATION TECHNOLOGY (HK) LIMITED
36 AS4766 Korea Telecom
35 AS132203 Tencent Building, Kejizhongyi Avenue
34 AS9829 National Internet Backbone
34 AS63949 Akamai Connected Cloud
27 AS16276 OVH SAS
24 AS51396 Pfcloud UG
24 AS211298 INTERNET MEASUREMENT
24 AS202425 IP Volume inc
24 AS198465 BtHoster LTD
21 AS394711 Limenet
17 AS20052 Arbor Networks, Inc.
17 AS10439 CariNet, Inc.
16 AS4713 NTT Communications Corporation
15 AS9009 M247 Europe SRL
15 AS211680 NSEC - Sistemas Informaticos, S.A.
13 AS58466 CHINANET Guangdong province network
12 AS51167 Contabo GmbH
12 AS3462 Data Communication Business Group
12 AS12876 SCALEWAY S.A.S.
10 AS9808 China Mobile Communications Group Co., Ltd.
10 AS36352 ColoCrossing
10 AS13213 UK-2 Limited
9 AS45102 Alibaba (US) Technology Co., Ltd.
8 AS7552 Viettel Group
8 AS50360 Tamatiya EOOD
8 AS36007 Kamatera, Inc.
8 AS34534 Harmony Hosting SARL
7 AS57523 Chang Way Technologies Co. Limited
7 AS21859 Zenlayer Inc
7 AS209605 UAB Host Baltic
7 AS198953 Proton66 OOO
6 AS174 Cogent Communications
6 AS140292 CHINATELECOM Jiangsu province Suzhou 5G network
5 AS49870 Alsycon B.V.
5 AS49581 Ferdinand Zink trading as Tube-Hosting
5 AS4808 China Unicom Beijing Province Network
5 AS3269 Telecom Italia S.p.A.
5 AS210644 AEZA INTERNATIONAL LTD
5 AS204428 SS-Net
5 AS149621 SB Secure Data centers India Private Limited
5 AS10617 SION S.A
4 AS9121 Turk Telekomunikasyon Anonim Sirketi
4 AS8151 UNINET
4 AS7018 AT&amp;T Services, Inc.
4 AS701 Verizon Business
4 AS53667 FranTech Solutions
4 AS23969 TOT Public Company Limited
4 AS208843 Alpha Strike Labs GmbH
4 AS207812 DM AUTO EOOD
4 AS201814 MEVSPACE sp. z o.o.
4 AS20001 Charter Communications Inc
4 AS19318 Interserver, Inc
4 AS140803 HQDATA
3 AS9318 SK Broadband Co Ltd
3 AS8075 Microsoft Corporation
3 AS7303 Telecom Argentina S.A.
3 AS714 Apple Inc.
3 AS58461 CT-HangZhou-IDC
3 AS5607 Sky UK Limited
3 AS4812 China Telecom (Group)
3 AS45899 VNPT Corp
3 AS398101 GoDaddy.com, LLC
3 AS38365 Beijing Baidu Netcom Science and Technology Co., Ltd.
3 AS33491 Comcast Cable Communications, LLC
3 AS3215 Orange S.A.
3 AS2527 Sony Network Communications Inc.
3 AS22552 eSited Solutions
3 AS211607 Securitytrails, LLC
3 AS12389 PJSC Rostelecom
2 AS9506 Singtel Fibre Broadband
2 AS9319 HCN CHUNGBUK CABLE TV SYSTEMS
2 AS8551 Bezeq International Ltd.
2 AS8048 CANTV Servicios, Venezuela
2 AS7545 TPG Telecom Limited
2 AS7418 TELEFÓNICA CHILE S.A.
2 AS62904 Eonix Corporation
2 AS62160 WEB3 Leaders INC
2 AS58212 dataforest GmbH
2 AS4811 China Telecom (Group)
2 AS47154 HUSAM A. H. HIJAZI
2 AS44592 SkyLink Data Center BV
2 AS42237 w1n ltd
2 AS41436 Kamatera Inc
2 AS398791 GoDaddy.com, LLC
2 AS39501 NGSAS NedaGostarSaba
2 AS38283 CHINANET SiChuan Telecom Internet Data Center
2 AS35916 MULTACOM CORPORATION
2 AS33363 Charter Communications, Inc
2 AS33182 HostDime.com, Inc.
2 AS31898 Oracle Corporation
2 AS26599 TELEFÔNICA BRASIL S.A
2 AS2635 Automattic, Inc
2 AS25369 Hydra Communications Ltd
2 AS2514 NTT PC Communications, Inc.
2 AS22773 Cox Communications Inc.
2 AS22501 Cooperativa Telefonica Carlos Tejedor Ltda.
2 AS212815 Dyjix SAS
2 AS209828 Genc BT Bilisim Teknolojileri Limited Sirketi
2 AS209559 XHOST INTERNET SOLUTIONS LP
2 AS208091 XHOST INTERNET SOLUTIONS LP
2 AS20214 Comcast Cable Communications, LLC
2 AS18779 EGIHosting
2 AS17676 SoftBank Corp.
2 AS17511 OPTAGE Inc.
2 AS17421 Mobile Business Group
2 AS16509 Amazon.com, Inc.
2 AS16232 Telecom Italia S.p.A.
2 AS15895 "Kyivstar" PJSC
2 AS150706 Hong Kong Zhengxing Technology Co., Ltd.
2 AS14618 Amazon.com, Inc.
2 AS142002 Scloud Pte Ltd
2 AS135944 VinhNam Commercial informatics service corporation
2 AS135905 VIETNAM POSTS AND TELECOMMUNICATIONS GROUP
2 AS134238 CHINANET Jiangx province IDC network
2 AS12683 PJSC Rostelecom
2 AS1267 WIND TRE S.P.A.
2 AS1257 Tele2 Sverige AB
2 AS12400 Partner Communications Ltd.
2 AS11492 CABLE ONE, INC.
1 AS9976 Namincheon Brodcasting Co., Ltd.
1 AS9845 LG HelloVision Corp.
1 AS9824 JCOM Co., Ltd.
1 AS9697 LG HelloVision Corp.
1 AS9689 SK Broadband Co Ltd
1 AS9595 NTT-ME Corporation
1 AS9316 DACOM-PUBNETPLUS
1 AS9304 HGC Global Communications Limited
1 AS9299 Philippine Long Distance Telephone Company
1 AS9198 JSC Kazakhtelecom
1 AS9050 ORANGE ROMANIA COMMUNICATION S.A
1 AS8612 Tiscali Italia S.P.A.
1 AS8595 OOO WestCall Ltd.
1 AS852 TELUS Communications Inc.
1 AS8473 Bahnhof AB
1 AS8447 A1 Telekom Austria AG
1 AS8374 Polkomtel Sp. z o.o.
1 AS8369 Intersvyaz-2 JSC
1 AS812 Rogers Communications Canada Inc.
1 AS786 Jisc Services Limited
1 AS7713 PT Telekomunikasi Indonesia
1 AS7470 TRUE INTERNET Co.,Ltd.
1 AS7377 University of California, San Diego
1 AS6871 Plusnet
1 AS680 Verein zur Foerderung eines Deutschen Forschungsnetzes e.V.
1 AS6799 Ote SA (Hellenic Telecommunications Organisation)
1 AS64227 CONSOLIDATED TELEPHONE COMPANY
1 AS63961 Bangladesh Research and Education Network (BdREN)
1 AS6327 Shaw Communications Inc.
1 AS61857 SPEEDFAST TELECOM
1 AS6167 Verizon Business
1 AS6147 Telefonica del Peru S.A.A.
1 AS6130 American Internet Services, LLC.
1 AS6128 Cablevision Systems Corp.
1 AS60068 Datacamp Limited
1 AS59477 LIFEPC, s.r.o.
1 AS58541 Qingdao,266000
1 AS58519 Cloud Computing Corporation
1 AS58321 Oxylion S. A.
1 AS58224 Iran Telecommunication Company PJS
1 AS57678 Cat Technologies Co. Limited
1 AS57588 Hayat for Internet &amp; communication LLC
1 AS57044 JSC "ER-Telecom Holding"
1 AS5650 Frontier Communications of America, Inc.
1 AS56478 Hyperoptic Ltd
1 AS56048 China Mobile Communicaitons Corporation
1 AS56047 China Mobile communications corporation
1 AS56046 China Mobile communications corporation
1 AS56042 China Mobile communications corporation
1 AS55720 Gigabit Hosting Sdn Bhd
1 AS55492 Dhaka Fiber Net Limited
1 AS5384 EMIRATES TELECOMMUNICATIONS GROUP COMPANY (ETISALAT GROUP) PJSC
1 AS53153 CINTE Telecom Comercio e Servicos Ltda.
1 AS53006 ALGAR TELECOM S/A
1 AS52936 ISOTELCO LTDA
1 AS52606 BRASILNETS COM. ATAC. DE EQ. INFORMATICA LTDA ME
1 AS52207 JSC "ER-Telecom Holding"
1 AS51852 Private Layer INC
1 AS51570 JSC "ER-Telecom Holding"
1 AS51115 HLL LLC
1 AS5089 Virgin Media Limited
1 AS49893 Bitrace telecom Ltd.
1 AS49202 Kisara LLC
1 AS49100 Pishgaman Toseeh Ertebatat Company (Private Joint Stock)
1 AS48854 team.blue Denmark A/S
1 AS48737 DoraTelekom
1 AS48715 Sefroyek Pardaz Engineering PJSC
1 AS4847 China Networks Inter-Exchange
1 AS48347 JSC Mediasoft ekspert
1 AS4816 China Telecom (Group)
1 AS48090 PPTECHNOLOGY LIMITED
1 AS47890 UNMANAGED LTD
1 AS4788 TM TECHNOLOGY SERVICES SDN. BHD.
1 AS47764 LLC VK
1 AS47583 Hostinger International Limited
1 AS46606 Unified Layer
1 AS4657 StarHub Ltd
1 AS45629 JasTel Network International Gateway
1 AS45458 SBN-ISP/AWN-ISP and SBN-NIX/AWN-NIX
1 AS44724 Octopusnet LTD
1 AS44634 LLC SibSvayzStroy
1 AS43260 DGN TEKNOLOJI A.S.
1 AS42668 Nevalink, LLC
1 AS400328 Intelligence Hosting LLC
1 AS398989 DeepIntent, Inc.
1 AS398722 Censys, Inc.
1 AS3920 ESTOXY OU
1 AS38478 SunnyVision Limited
1 AS38372 RJNET
1 AS38264 National WiMAX/IMS environment
1 AS38096 SK Broadband Co Ltd
1 AS3786 LG DACOM Corporation
1 AS37608 iRENALA
1 AS37517 CV  Multimedia SA
1 AS36925 MEDITELECOM
1 AS36493 FIBERNETICS CORPORATION
1 AS36459 GitHub, Inc.
1 AS3605 Guam Cablevision, LLC.
1 AS35562 Kedr Ltd.
1 AS35125 PJSC Rostelecom
1 AS34984 Superonline Iletisim Hizmetleri A.S.
1 AS34622 Bredband i Kristianstad AB
1 AS33915 Vodafone Libertel B.V.
1 AS33668 Comcast Cable Communications, LLC
1 AS33659 Comcast Cable Communications, LLC
1 AS33588 Charter Communications
1 AS3329 VODAFONE-PANAFON HELLENIC TELECOMMUNICATIONS COMPANY SA
1 AS3303 Swisscom (Schweiz) AG
1 AS3301 Telia Company AB
1 AS328608 Africa on Cloud
1 AS3209 Vodafone GmbH
1 AS31213 PJSC MegaFon
1 AS31133 PJSC MegaFon
1 AS31034 Aruba S.p.A.
1 AS30722 Vodafone Italia S.p.A.
1 AS30036 Mediacom Communications Corp
1 AS29484 Ruhr-Universitaet Bochum
1 AS28573 Claro NXT Telecomunicacoes Ltda
1 AS2856 British Telecommunications PLC
1 AS28294 B S Costa Telecom
1 AS28283 Adylnet Telecom
1 AS28209 Under Servicos de Internet Ltda
1 AS27951 Media Commerce Partners S.A
1 AS27882 Telefónica Celular de Bolivia S.A.
1 AS270719 START NET TELECOM LTDA
1 AS269832 MDS TELECOM C.A.
1 AS269608 VELOSO NET SERV DE COMUNICACAO MULTIDIA EIRELI
1 AS267784 Flyservers S.A.
1 AS266608 Ola Fibra Telecomunicacoes LTDA
1 AS266181 GOLDEN LINK
1 AS263056 INDNET TELECOMUNICACOES LTDA
1 AS26277 ServerPoint.com
1 AS262663 METROFLEX TELECOMUNICACOES LTDA
1 AS262378 Compuservice Empreendimentos Ltda
1 AS262318 Horizons Telecomunicações e Tecnologia S.A.
1 AS2519 ARTERIA Networks Corporation
1 AS2518 BIGLOBE Inc.
1 AS2516 KDDI CORPORATION
1 AS25106 Mobile TeleSystems JLLC
1 AS25019 Saudi Telecom Company JSC
1 AS24961 myLoc managed IT AG
1 AS24700 WEB3 Leaders INC
1 AS24560 Bharti Airtel Ltd., Telemedia Services
1 AS24547 Hebei Mobile Communication Company Limited
1 AS24444 Shandong Mobile Communication Company Limited
1 AS24164 UNION BROADBAND NETWORK
1 AS23724 IDC, China Telecommunications Corporation
1 AS22408 West Ky Networks
1 AS216240 MortalSoft Ltd.
1 AS216167 Skoali SAS
1 AS215862 Taliene De Araujo Souza
1 AS213402 Rahat Telecom LLC
1 AS213149 Telelink Telecommunications Co for Internet services and Information Technology Ltd.
1 AS212913 FOP Hornostay Mykhaylo Ivanovych
1 AS211715 Partlix, Ltd.
1 AS2116 GLOBALCONNECT AS
1 AS211557 TAYNET TEKNOLOJI TICARET LIMITED SIRKETI
1 AS211235 AL-SAHIN AL-SHABALY Co. for Internet Services Ltd
1 AS211056 Amir Hosein Maaref
1 AS210218 Open Fiber S.P.A.
1 AS209711 MUV Bilisim ve Telekomunikasyon Hizmetleri Ltd. Sti.
1 AS209 CenturyLink Communications, LLC
1 AS208258 Access2.IT Group B.V.
1 AS207147 NETCOM GROUP SAS
1 AS206264 Amarutu Technology Ltd
1 AS206216 Advin Services LLC
1 AS206119 Veganet Teknolojileri ve Hizmetleri LTD STI
1 AS20473 The Constant Company, LLC
1 AS202520 SkyPass Solutions Sp. z.o.o.
1 AS202468 Noyan Abr Arvan Co. ( Private Joint Stock)
1 AS201776 Miranda-Media Ltd
1 AS20115 Charter Communications
1 AS19871 Network Solutions, LLC
1 AS197183 Occentus Network SL
1 AS197078 Yarnet Ltd
1 AS19037 AMX Argentina S.A.
1 AS18822 Manquehuenet
1 AS18809 Cable Onda
1 AS18403 FPT Telecom Company
1 AS18144 Energia Communications,Inc.
1 AS18081 Kintetsu Cable Network Co., Ltd.
1 AS18049 Taiwan Infrastructure Network Technologie
1 AS17858 LG POWERCOMM
1 AS17809 VEE TIME CORP.
1 AS17747 SITI NETWORKS LIMITED
1 AS17698 COMMUNITY NETWORK CENTER INCORPORATED.
1 AS17665 ONEOTT INTERTAINMENT LIMITED
1 AS17639 Converge ICT Solutions Inc.
1 AS17488 Hathway IP Over Cable Internet
1 AS17451 BIZNET NETWORKS
1 AS16863 Home Telephone Company, Inc.
1 AS16629 CTC. CORP S.A. (TELEFONICA EMPRESAS)
1 AS16116 Pelephone Communications Ltd.
1 AS15704 XTRA TELECOM S.A.
1 AS15493 "Russian company" LLC
1 AS15169 Google LLC
1 AS151487 Awesomecloud Limited
1 AS149570 Speech Tell Communication Private Limited
1 AS147176 NZ Network Enterprise Co., Ltd.
1 AS142111 Zhejiang Aiyun Network Technology Co Ltd
1 AS141679 China Telecom Beijing Tianjin Hebei Big Data Industry Park Branch
1 AS141480 Haash Media
1 AS141152 BATAAN SPACE CABLE NETWORK INC
1 AS140726 UNICOM AnHui province network
1 AS1403 EBOX
1 AS139752 Multinetwork Cable Television, Inc
1 AS139281 Equinix Korea LLC
1 AS138968 rainbow network limited
1 AS138152 YISU CLOUD LTD
1 AS138025 RBC Cable Master System
1 AS137941 Mabuhay Cable TV Inc
1 AS137718 Beijing Volcano Engine Technology Co., Ltd.
1 AS137443 Anchnet Asia Limited
1 AS136052 PT Cloud Hosting Indonesia
1 AS135161 GMO-Z com NetDesign Holdings Co., Ltd.
1 AS13490 Buckeye Cablevision, Inc.
1 AS13489 EPM Telecomunicaciones S.A. E.S.P.
1 AS134810 China Mobile Group JiLin communications corporation
1 AS134765 CHINANET Yunnan province IDC1 network
1 AS134762 CHINANET Liaoning province Dalian MAN network
1 AS134756 CHINANET Nanjing Jishan IDC network
1 AS134420 Chongqing Telecom
1 AS134143 Professional Data Kinetics Pty Ltd
1 AS133676 Precious netcom pvt ltd
1 AS133159 Mammoth Media Pty Ltd
1 AS132335 LeapSwitch Networks Pvt Ltd
1 AS13188 CONTENT DELIVERY NETWORK LTD
1 AS131414 Long Van Soft Solution JSC
1 AS131353 NhanHoa Software company
1 AS131090 CAT TELECOM Public Company Ltd,CAT
1 AS12897 ENTEGA Medianet GmbH
1 AS12874 Fastweb SpA
1 AS12849 Hot-Net internet services Ltd.
1 AS12735 TurkNet Iletisim Hizmetleri A.S.
1 AS12730 PJSC Rostelecom
1 AS12494 OOO "Post ltd"
1 AS12322 Free SAS
1 AS1221 Telstra Corporation Ltd
1 AS11830 Instituto Costarricense de Electricidad y Telecom.
1 AS11351 Charter Communications Inc
1 AS10796 Charter Communications Inc
1 AS10269 Belize Telemedia Limited</code></pre></figure><div class="code-label"> Output</div></div></div><h4 id="interpretation-of-blocked-scans-by-organization">Interpretation of Blocked Scans by Organization</h4><figure class="article"><picture> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-top-scans-by-organization-440-52ea97b98.avif 440w, /assets/img/ufw-fail2ban-nginx-top-scans-by-organization-950-52ea97b98.avif 950w" type="image/avif" /> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-top-scans-by-organization-440-cce1a9e13.jpeg 440w, /assets/img/ufw-fail2ban-nginx-top-scans-by-organization-950-cce1a9e13.jpeg 950w" type="image/jpeg" /> <img src="/assets/img/ufw-fail2ban-nginx-top-scans-by-organization-800-cce1a9e13.jpeg" alt="Top 20 organizations with the highest number of scans" width="950" height="480" /> </picture><figcaption>Top 20 Organizations with the highest number of scans</figcaption></figure><ul><li><strong>1. Google LLC (AS396982)</strong><ul><li><strong>Number of occurrences</strong>: 590</li><li><strong>Implication</strong>: Significant activity from IP addresses associated with Google, indicating potential use of Google services for network scanning or misuse of their PaaS GCP platform.</li></ul></li><li><strong>2. DigitalOcean, LLC (AS14061)</strong><ul><li><strong>Number of occurrences</strong>: 384</li><li><strong>Implication</strong>: High scanning activity from this cloud organization, suggesting either legitimate services or potentially compromised cloud instances.</li></ul></li><li><strong>3. Hurricane Electric LLC (AS6939)</strong><ul><li><strong>Number of occurrences</strong>: 165</li><li><strong>Implication</strong>: Notable presence of scans from this Internet service provider, possibly indicating abuse of its services for scanning activities.</li></ul></li><li><strong>4. Chinese Organizations</strong><ul><li><strong>Number of occurrences</strong>:<ul><li>CHINANET-BACKBONE (AS4134): 108</li><li>Hangzhou Alibaba (AS37963): 71</li><li>Tencent (AS45090): 59</li><li>CHINA UNICOM (AS4837): 54</li><li>Other Chinese organizations with significant occurrences</li></ul></li><li><strong>Implication</strong>: Scanning activities emanating from major Chinese corporations, reflecting either legitimate operations or abuse of their networks.</li></ul></li><li><strong>5. Censys, Inc. (AS398324, AS398705)</strong><ul><li><strong>Number of occurrences</strong>: Total of 145</li><li><strong>Implication</strong>: Censys, a data security-focused company, appears engaged in scanning activity, likely in a security research context.</li></ul></li><li><strong>6. OVH SAS (AS16276) and Other Hosting Providers</strong><ul><li><strong>Implication</strong>: Scans from OVH and other hosting providers may indicate either legitimate services or abuse of hosting resources.</li></ul></li><li><strong>7. Diversity of Global Sources</strong><ul><li><strong>Implication</strong>: The presence of organizations from many countries (e.g., KR, IN, RU, JP, VN) shows a diversity in the geographical origin of scans, which may reflect a wide range of intentions and practices.</li></ul></li><li><strong>8. Scanning Activities by ISPs and Telecommunications Companies</strong><ul><li><strong>Examples</strong>: Korea Telecom (AS4766), NTT Communications (AS4713)</li><li><strong>Implication</strong>: These ISPs and telecommunications companies may be involved in scans for maintenance, security, or other legitimate activities.</li></ul></li></ul><p>These statistics underscore the importance of ongoing monitoring and protection against potentially malicious scanning activities. The diversity of sources, ranging from cloud service providers to major telecommunications companies, illustrates the complexity of the online security ecosystem.</p><h3 id="scans-by-city">Scans by City</h3><h4 id="results-2">Results</h4><div class="code-container"><div class="code-window"><div class="window-header"><div class="window-controls"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"> <g fill="none" fill-rule="evenodd" transform="translate(1 1)"> <circle cx="6" cy="6" r="6" fill="#EC6A5E" stroke="#EC6A5E" stroke-width=".5" /> <circle cx="26" cy="6" r="6" fill="#F4BF4F" stroke="#F4BF4F" stroke-width=".5" /> <circle cx="46" cy="6" r="6" fill="#61C554" stroke="#61C554" stroke-width=".5" /> </g> </svg></div><div class="window-copy"> <svg xmlns="http://www.w3.org/2000/svg" class="window-copy-icon" height="24" width="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path> </svg></div></div><figure class="highlight"><pre><code class="language-output" data-lang="output">314 San Francisco
    218 London
    210 North Charleston
    107 Chicago
    103 Amsterdam
     77 Pleasanton
     75 Frankfurt am Main
     62 Kingsburg
     57 Shenzhen
     55 São Paulo
     50 Shanghai
     48 Taichung
     45 Brussels
     42 Beijing
     38 Council Bluffs
     33 Nanjing
     32 Hangzhou
     25 Hopel
     24 Thetford
     22 Paris
     22 Hong Kong
     21 Singapore
     21 Santa Clara
     20 San Diego
     18 Morris Plains
     18 Los Angeles
     17 Moscow
     17 Ann Arbor
     16 Tokyo
     16 Sofia
     16 North Bergen
     15 Seoul
     14 Shenyang
     14 Palo Alto
     12 Chengdu
     11 Wuhan
     11 Taiyuan
     10 Taipei
     10 Sydney
     10 Stockholm
     10 San Mateo
     10 Ho Chi Minh City
     10 Clifton
     10 Bangkok
      9 Qingdao
      9 Milan
      9 Kunming
      9 Jakarta
      9 Fremont
      9 Chongqing
      8 Saint Petersburg
      8 Roubaix
      8 Changchun
      7 Phoenix
      7 New York City
      7 Lille
      7 Istanbul
      7 Beauharnois
      6 Zhengzhou
      6 Zhangjiakou
      6 Warsaw
      6 Toronto
      6 Dallas
      6 Buffalo
      6 Ashburn
      6 Aachen
      5 Vilnius
      5 Mumbai
      5 Mangalagiri
      5 Harbin
      5 Hanoi
      5 Haarlem
      5 Changsha
      5 Bengaluru
      4 Thiruvananthapuram
      4 Tehran
      4 Santiago
      4 Richardson
      4 Las Vegas
      4 Incheon
      4 Düsseldorf
      4 Berlin
      4 Atlanta
      3 Thoothukudi
      3 Shanxi
      3 Seattle
      3 San Jose
      3 Reston
      3 Prague
      3 Nürnberg
      3 Montréal
      3 Lagos Island
      3 Kollam
      3 Hefei
      3 Gwangju
      3 Guiyang
      3 Guangzhou
      3 General Alvear
      3 Chennai
      3 Caracas
      3 Busan
      3 Banqiao
      3 Baghdad
      2 Zürich
      2 Xining
      2 Vinh
      2 Vienna
      2 Utsunomiya
      2 Timişoara
      2 Tianjin
      2 The Dalles
      2 Suwon
      2 Shijiazhuang
      2 Seongnam-si
      2 Rio de Janeiro
      2 Pyatigorsk
      2 Portsmouth
      2 Philadelphia
      2 Palermo
      2 Olathe
      2 Nanchang
      2 Mito
      2 Miryang
      2 Mar del Plata
      2 Kolkata
      2 Kaunas
      2 Jalandhar
      2 Hunan
      2 Hoàn Kiếm
      2 Hazāribāgh
      2 Gruzino
      2 Göteborg
      2 Fuzhou
      2 Fengshan
      2 Dubai
      2 Doddaballapura
      2 Dhaka
      2 Contai
      2 Coimbatore
      2 Chinch'ŏn
      2 Cheongju-si
      2 Central
      2 Buenos Aires
      2 Ankara
      1 Đồng Hới
      1 Ōtsu
      1 Şişli
      1 Ōbu
      1 Zolotonosha
      1 Zhongxing New Village
      1 Zhenjiang
      1 Zhanjiang
      1 Zapolyarnyy
      1 Yongsan-dong
      1 Yogyakarta
      1 Yingkou
      1 Yilan
      1 Yigo Village
      1 Yesan
      1 Yelets
      1 Yekaterinburg
      1 Yecheon
      1 Yaroslavl
      1 Yangsan
      1 Yangquan
      1 Xi’an
      1 Wrocław
      1 Winter Park
      1 Whittier
      1 Waterloo
      1 Waterford
      1 Wakefield
      1 Waegwan
      1 Volgograd
      1 Vladivostok
      1 Vigia
      1 Veranópolis
      1 Vancouver
      1 Valencia
      1 Una
      1 Ulsan
      1 Uberlândia
      1 T’aebaek
      1 Tyumen
      1 Tula
      1 Tuguegarao
      1 Trelew
      1 Tilburg
      1 Thessaloníki
      1 The Acreage
      1 Thái Nguyên
      1 Tempe
      1 Tefé
      1 Tân An
      1 Takasaki
      1 Tainan
      1 Sylvania
      1 Surat Thani
      1 Stratford-upon-Avon
      1 Strasbourg
      1 Southend-on-Sea
      1 South Riding
      1 Smolensk
      1 Simferopol
      1 Shulin
      1 Shaoxing
      1 Sevastopol
      1 Serpong
      1 Sergiyev Posad
      1 Sejong
      1 Secaucus
      1 Satellite Beach
      1 Sardinal
      1 Sapporo
      1 Santa Monica
      1 Santa Fe
      1 San Pedro
      1 Samut Songkhram
      1 Sainte-Geneviève-des-Bois
      1 Saint-Quentin-en-Yvelines
      1 Ryazan’
      1 Rondonópolis
      1 Rome
      1 Riverside
      1 Rishon LeTsiyyon
      1 Raebareli
      1 Quận Bốn
      1 Puerto Madryn
      1 Provo
      1 Praia
      1 Poznań
      1 Pohang
      1 Petaling Jaya
      1 Pathanāmthitta
      1 Passos
      1 Pasig City
      1 Paripark
      1 Pardīs
      1 Panvel
      1 Panama City
      1 Palm Beach Gardens
      1 Padova
      1 Oslo
      1 Osaka
      1 Okayama
      1 Novosibirsk
      1 Nova Iguaçu
      1 Ningbo
      1 Niagara Falls
      1 New Delhi
      1 Neietsu
      1 Neapoli
      1 Naples
      1 Nanning
      1 Nagoya
      1 Murray
      1 Munich
      1 Motoyoyogichō
      1 Morro
      1 Monterrey
      1 Mokotów
      1 Minsk
      1 Minatitlán
      1 Michelstadt
      1 Miaoli
      1 Melbourne
      1 Massy
      1 Masan
      1 Masaguisi
      1 Marinilla
      1 Manila
      1 Magnitogorsk
      1 Mafra
      1 Mâcon
      1 Machida
      1 Macapá
      1 Luxembourg
      1 Lutsk
      1 Ludhiāna
      1 Liverpool
      1 Linfen
      1 Largo
      1 La Paz
      1 Kōriyama
      1 Kyiv
      1 Kurashiki
      1 Köln
      1 Koesan
      1 Kobe
      1 Kislovodsk
      1 Kimhae
      1 Kharkiv
      1 Kalispell
      1 Jinrongjie
      1 Jinan
      1 Jiaxing
      1 Jerusalem
      1 Jeju City
      1 Isparta
      1 Isfahan
      1 Indianapolis
      1 Imperatriz
      1 Iksan
      1 Ikoma
      1 Ichikawa-minami
      1 Hwawŏn
      1 Huzhou
      1 Huizhou
      1 Hrochoť
      1 Honolulu
      1 Hohhot
      1 Hitachi-Naka
      1 Hisar
      1 Hicksville
      1 Heyuan
      1 Hatsudai
      1 Harston
      1 Hammarslund
      1 Hamburg
      1 Halesowen
      1 Haikou
      1 Haifa
      1 Hadano
      1 Gumi
      1 Guanajuato
      1 Guadalajara
      1 Groningen
      1 Greenford
      1 Goose Creek
      1 Goochland
      1 Gold Coast
      1 Goiânia
      1 Gifu-shi
      1 Giddalūr
      1 Ghāziābād
      1 Genoa
      1 Gangseo-gu
      1 Fukuyama
      1 Fontana
      1 Florence
      1 Feltham
      1 Faisalabad
      1 Essen
      1 Englewood Cliffs
      1 El Pedregal
      1 Ekibastuz
      1 Eilat
      1 Ecoporanga
      1 Douliu
      1 Doral
      1 Derval
      1 Dammam
      1 Daejeon
      1 Da Nang
      1 Curitiba
      1 Cormano
      1 Çorlu
      1 Córdoba
      1 Corcuera
      1 Columbus
      1 Ciudad López Mateos
      1 Cirebon
      1 Cincinnati
      1 Cibinong
      1 Chư Ty
      1 Chiang Mai
      1 Chernihiv
      1 Changde
      1 Chandīgarh
      1 Chandler
      1 Ceres
      1 Castiglione delle Stiviere
      1 Casablanca
      1 Cambridge
      1 Cabanatuan City
      1 Bursa
      1 Burnaby
      1 Bucharest
      1 Bryansk
      1 Brampton
      1 Boydton
      1 Bologna
      1 Bogotá
      1 Bochum
      1 Boardman
      1 Bhopāl
      1 Belford Roxo
      1 Balanga
      1 Baku
      1 Atlantic City
      1 Ashdod
      1 Antananarivo
      1 Anseong
      1 Andong
      1 Anderson
      1 Amritsar
      1 Akashi
      1 Aitkin
      1 Ahvaz
      1 Ahmedabad
      1 Adelaide
      1 Aabenraa</code></pre></figure><div class="code-label"> Output</div></div></div><h4 id="interpretation-of-blocked-scans-statistics-by-city">Interpretation of Blocked Scans Statistics by City</h4><figure class="article"><picture> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-top-scans-by-city-440-eaf67bfc9.avif 440w, /assets/img/ufw-fail2ban-nginx-top-scans-by-city-950-eaf67bfc9.avif 950w" type="image/avif" /> <source sizes="(max-width : 769px) 100vw, (max-width : 1119px) 100vw, (min-width: 1120px) 980px" srcset="/assets/img/ufw-fail2ban-nginx-top-scans-by-city-440-605c10460.jpeg 440w, /assets/img/ufw-fail2ban-nginx-top-scans-by-city-950-605c10460.jpeg 950w" type="image/jpeg" /> <img src="/assets/img/ufw-fail2ban-nginx-top-scans-by-city-800-605c10460.jpeg" alt="Top 20 cities with the highest number of scans" width="950" height="566" /> </picture><figcaption>Top 20 Cities with the highest number of scans</figcaption></figure><ul><li><strong>1. San Francisco (314 Occurrences)</strong><ul><li><strong>Implication</strong>: Significant activity from this technologically advanced city, likely reflecting the use of services based in Silicon Valley.</li></ul></li><li><strong>2. London (218 Occurrences)</strong><ul><li><strong>Implication</strong>: Strong activity from this global metropolis, suggesting scanning operations from companies based in London or using services hosted there.</li></ul></li><li><strong>3. North Charleston (210 Occurrences)</strong><ul><li><strong>Implication</strong>: A surprising number of scans from this city, possibly indicating the presence of cloud service infrastructures or other technology companies.</li></ul></li><li><strong>4. Chinese Cities (Shenzhen, Shanghai, Beijing, etc.)</strong><ul><li><strong>Total Occurrences</strong>: Over 150</li><li><strong>Implication</strong>: Significant scans emanating from several major Chinese cities, illustrating the breadth of technological and digital presence in China.</li></ul></li><li><strong>5. Amsterdam (103 Occurrences)</strong><ul><li><strong>Implication</strong>: With its cloud service infrastructure and data centers, Amsterdam is a notable source of scans.</li></ul></li><li><strong>6. Frankfurt am Main (75 Occurrences)</strong><ul><li><strong>Implication</strong>: High activity in this German city, known for its data centers and key role in European networks.</li></ul></li><li><strong>7. Diversity of Global Sources</strong><ul><li><strong>Implication</strong>: The variety of cities (such as Seoul, Tokyo, Paris, Moscow) indicates a global distribution of scan sources, reflecting the global nature of online activity and potential threats.</li></ul></li><li><strong>8. Specific Activities of Certain Cities</strong><ul><li><strong>Examples</strong>: São Paulo, Singapore, Santa Clara</li><li><strong>Implication</strong>: These cities, known for their concentration of technology companies, show scanning activity that may be attributed to legitimate research or network abuses.</li></ul></li></ul><p>These statistics highlight the geographical diversity of scanning activities and underscore the importance of cybersecurity measures. The presence of scans from major technological and financial cities indicates that these regions are hotspots for online activities, necessitating increased vigilance for network protection.</p><hr class="hr-text" data-content="Conclusion" /><h2 id="conclusion">Conclusion</h2><p>Securing your Nginx server with Fail2ban and UFW is a crucial step in protecting your data and infrastructure against increasingly sophisticated cyber attacks. In this article, we have seen how Fail2ban and UFW can be used together to form a robust barrier against attacks, by combining the detection and banning of malicious IP addresses with rigorous management of network traffic.</p><p>Implementing these tools is just the beginning of an ongoing security process. It is essential to keep these systems updated, regularly adjust configurations in response to new threats, and continuously monitor logs for intrusion attempts. Data analysis clearly demonstrates the importance of these tools in detecting and blocking a multitude of unauthorized access attempts from around the world.</p><p>Finally, keep in mind that security is an evolving practice. Threats are constantly changing, and our defense methods must adapt accordingly. Do not hesitate to explore new tools, share your knowledge with the community, and stay informed of the latest trends in cybersecurity.</p><p>Stay safe, stay secure!</p><div class="page-footer"><div class="page-share"><div class="social-left"><div class="social-item"> <span><svg width="23.75" height="19" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"/></svg></span></div><div class="page-tag"><ul><li><a class="tag" href="/en/tags#UFW" rel="tag">UFW</a></li><li><a class="tag" href="/en/tags#Fail2ban" rel="tag">Fail2ban</a></li><li><a class="tag" href="/en/tags#Nginx" rel="tag">Nginx</a></li><li><a class="tag" href="/en/tags#Security" rel="tag">Security</a></li><li><a class="tag" href="/en/tags#Cybersecurity" rel="tag">Cybersecurity</a></li><li><a class="tag" href="/en/tags#DevSecOps" rel="tag">DevSecOps</a></li></ul></div></div><div class="social-right"><div class="social-item"> <a href="mailto:?subject=Turn%20Your%20Nginx%20Server%20into%20a%20Fortress%20with%20Fail2ban%20and%20UFW&body=https://scalastic.io/en/ufw-fail2ban-nginx/" title="Share on email" rel="noreferrer nofollow"><span><svg xmlns="http://www.w3.org/2000/svg" style="vertical-align: -0.25em;" height="30px" viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"/></svg></span></a></div><div class="social-item"> <a href="https://bsky.app/intent/compose?text=Turn%20Your%20Nginx%20Server%20into%20a%20Fortress%20with%20Fail2ban%20and%20UFW%20https://scalastic.io/en/ufw-fail2ban-nginx/" title="Share on Bluesky" rel="noreferrer nofollow"><span><svg xmlns="http://www.w3.org/2000/svg" style="vertical-align: -0.25em;" height="30px" viewBox="0 0 448 512"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32zM224 247.4c14.5-30 54-85.8 90.7-113.3c26.5-19.9 69.3-35.2 69.3 13.7c0 9.8-5.6 82.1-8.9 93.8c-11.4 40.8-53 51.2-90 44.9c64.7 11 81.2 47.5 45.6 84c-67.5 69.3-97-17.4-104.6-39.6c0 0 0 0 0 0l-.3-.9c-.9-2.6-1.4-4.1-1.8-4.1s-.9 1.5-1.8 4.1c-.1 .3-.2 .6-.3 .9c0 0 0 0 0 0c-7.6 22.2-37.1 108.8-104.6 39.6c-35.5-36.5-19.1-73 45.6-84c-37 6.3-78.6-4.1-90-44.9c-3.3-11.7-8.9-84-8.9-93.8c0-48.9 42.9-33.5 69.3-13.7c36.7 27.5 76.2 83.4 90.7 113.3z"/></svg></span></a></div><div class="social-item"> <a href="https://mastodonshare.com/share?text=Turn%20Your%20Nginx%20Server%20into%20a%20Fortress%20with%20Fail2ban%20and%20UFW&url=https://scalastic.io/en/ufw-fail2ban-nginx/" title="Share on Mastodon" rel="noreferrer nofollow"><span><svg xmlns="http://www.w3.org/2000/svg" style="vertical-align: -0.25em;" height="30px" viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg></span></a></div><div class="social-item"> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://scalastic.io/en/ufw-fail2ban-nginx/" title="Share on LinkedIn" rel="noreferrer nofollow"><span><svg style="vertical-align: -0.25em;" height="30px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></span></a></div></div></div></div><div class="page-author"><div class="author-pres"><div class="author-img"><picture> <source srcset="/assets/img/jean-jerome-levy-100-b6f0419a8.avif 1.0x, /assets/img/jean-jerome-levy-200-b6f0419a8.avif 2.0x" type="image/avif"> <source srcset="/assets/img/jean-jerome-levy-100-e7cb5d968.jpg 1.0x, /assets/img/jean-jerome-levy-200-e7cb5d968.jpg 2.0x" type="image/jpeg"> <img class="author-img" src="/assets/img/jean-jerome-levy-100-e7cb5d968.jpg" alt="Jean-Jerome Levy" width="512" height="512"> </picture></div><div class="author-info"><p class="intro">Written by</p><a href="/en/jean-jerome-levy/"><h2 class="name">Jean-Jerome Levy</h2></a><p class="title">DevOps Consultant</p></div></div><div class="author-desc"><p>Seasoned professional in the field of information technology, I bring over 20 years of experience from working within major corporate IT departments. My diverse expertise has played a pivotal role in a myriad of projects, marked by the implementation of innovative DevOps practices.</p></div><div class="available-banner"> <a href="/en/jean-jerome-levy/"> <strong>Available for innovative DevOps projects!</strong> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" height="28" fill="white"><path d="M0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM297 385c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l71-71L120 280c-13.3 0-24-10.7-24-24s10.7-24 24-24l214.1 0-71-71c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0L409 239c9.4 9.4 9.4 24.6 0 33.9L297 385z"/> </svg> </a></div></div><div><h3>You may also like...</h3><div class="page-recomm"><div class="recomm"> <a class="recomm-link" href="/en/black-basta-ransomware-tactics/" aria-label="Black Basta: The Tactics and Techniques of Formidable Hackers"><h5>Black Basta: The Tactics and Techniques of Formidable Hackers</h5><div class="image-container"><picture> <source srcset="/assets/img/black-basta-ransomware-tactics-300-a4a33cec8.avif 1.0x, /assets/img/black-basta-ransomware-tactics-600-a4a33cec8.avif 2.0x" type="image/avif"> <source srcset="/assets/img/black-basta-ransomware-tactics-300-a913dc0b4.jpg 1.0x, /assets/img/black-basta-ransomware-tactics-600-a913dc0b4.jpg 2.0x" type="image/jpeg"> <img width="300" height="250" src="/assets/img/black-basta-ransomware-tactics-300-a913dc0b4.jpg" alt="Black Basta: The Tactics and Techniques of Formidable Hackers"> </picture></div></a></div><div class="recomm"> <a class="recomm-link" href="/en/devops-vs-zombies/" aria-label="DevOps Defense: How to Counter a Zombie Attack"><h5>DevOps Defense: How to Counter a Zombie Attack</h5><div class="image-container"><picture> <source srcset="/assets/img/devops-vs-zombies-300-9531dcb8e.avif 1.0x, /assets/img/devops-vs-zombies-600-9531dcb8e.avif 2.0x" type="image/avif"> <source srcset="/assets/img/devops-vs-zombies-300-ceb43d93f.jpg 1.0x, /assets/img/devops-vs-zombies-600-ceb43d93f.jpg 2.0x" type="image/jpeg"> <img width="300" height="250" src="/assets/img/devops-vs-zombies-300-ceb43d93f.jpg" alt="DevOps Defense: How to Counter a Zombie Attack"> </picture></div></a></div><div class="recomm"> <a class="recomm-link" href="/en/zero-trust-kubernetes/" aria-label="Zero Trust: The New Norm for Securing Your Kubernetes Cluster"><h5>Zero Trust: The New Norm for Securing Your Kubernetes Cluster</h5><div class="image-container"><picture> <source srcset="/assets/img/zero-trust-kubernetes-300-b7ed8be8d.avif 1.0x, /assets/img/zero-trust-kubernetes-600-b7ed8be8d.avif 2.0x" type="image/avif"> <source srcset="/assets/img/zero-trust-kubernetes-300-a50c12efc.jpg 1.0x, /assets/img/zero-trust-kubernetes-600-a50c12efc.jpg 2.0x" type="image/jpeg"> <img width="300" height="250" src="/assets/img/zero-trust-kubernetes-300-a50c12efc.jpg" alt="Zero Trust: The New Norm for Securing Your Kubernetes Cluster"> </picture></div></a></div><div class="recomm"> <a class="recomm-link" href="/en/update-docker-image/" aria-label="Towards DevOps Excellence: Explore Docker Update Automation"><h5>Towards DevOps Excellence: Explore Docker Update Automation</h5><div class="image-container"><picture> <source srcset="/assets/img/update-docker-image-300-b64d7ecf7.avif 1.0x, /assets/img/update-docker-image-600-b64d7ecf7.avif 2.0x" type="image/avif"> <source srcset="/assets/img/update-docker-image-300-b510ca353.jpg 1.0x, /assets/img/update-docker-image-600-b510ca353.jpg 2.0x" type="image/jpeg"> <img width="300" height="250" src="/assets/img/update-docker-image-300-b510ca353.jpg" alt="Towards DevOps Excellence: Explore Docker Update Automation"> </picture></div></a></div></div></div></div></div><div class='rocket'> <svg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'><path d='M2.81,14.12L5.64,11.29L8.17,10.79C11.39,6.41 17.55,4.22 19.78,4.22C19.78,6.45 17.59,12.61 13.21,15.83L12.71,18.36L9.88,21.19L9.17,17.66C7.76,17.66 7.76,17.66 7.05,16.95C6.34,16.24 6.34,16.24 6.34,14.83L2.81,14.12M5.64,16.95L7.05,18.36L4.39,21.03H2.97V19.61L5.64,16.95M4.22,15.54L5.46,15.71L3,18.16V16.74L4.22,15.54M8.29,18.54L8.46,19.78L7.26,21H5.84L8.29,18.54M13,9.5A1.5,1.5 0 0,0 11.5,11A1.5,1.5 0 0,0 13,12.5A1.5,1.5 0 0,0 14.5,11A1.5,1.5 0 0,0 13,9.5Z'/></svg></div></article></div><aside class="right-sidebar"><div class="share-links"><div class="share-item"> <a href="mailto:?subject=Turn%20Your%20Nginx%20Server%20into%20a%20Fortress%20with%20Fail2ban%20and%20UFW&body=https://scalastic.io/en/ufw-fail2ban-nginx/" title="Share on email" rel="noreferrer nofollow"><span><svg xmlns="http://www.w3.org/2000/svg" style="vertical-align: -0.25em;" height="30px" viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"/></svg></span></a></div><div class="share-item"> <a href="https://bsky.app/intent/compose?text=Turn%20Your%20Nginx%20Server%20into%20a%20Fortress%20with%20Fail2ban%20and%20UFW%20https://scalastic.io/en/ufw-fail2ban-nginx/" title="Share on Bluesky" rel="noreferrer nofollow"><span><svg xmlns="http://www.w3.org/2000/svg" style="vertical-align: -0.25em;" height="30px" viewBox="0 0 448 512"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32zM224 247.4c14.5-30 54-85.8 90.7-113.3c26.5-19.9 69.3-35.2 69.3 13.7c0 9.8-5.6 82.1-8.9 93.8c-11.4 40.8-53 51.2-90 44.9c64.7 11 81.2 47.5 45.6 84c-67.5 69.3-97-17.4-104.6-39.6c0 0 0 0 0 0l-.3-.9c-.9-2.6-1.4-4.1-1.8-4.1s-.9 1.5-1.8 4.1c-.1 .3-.2 .6-.3 .9c0 0 0 0 0 0c-7.6 22.2-37.1 108.8-104.6 39.6c-35.5-36.5-19.1-73 45.6-84c-37 6.3-78.6-4.1-90-44.9c-3.3-11.7-8.9-84-8.9-93.8c0-48.9 42.9-33.5 69.3-13.7c36.7 27.5 76.2 83.4 90.7 113.3z"/></svg></span></a></div><div class="share-item"> <a href="https://mastodonshare.com/share?text=Turn%20Your%20Nginx%20Server%20into%20a%20Fortress%20with%20Fail2ban%20and%20UFW&url=https://scalastic.io/en/ufw-fail2ban-nginx/" title="Share on Mastodon" rel="noreferrer nofollow"><span><svg xmlns="http://www.w3.org/2000/svg" style="vertical-align: -0.25em;" height="30px" viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg></span></a></div><div class="share-item"> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://scalastic.io/en/ufw-fail2ban-nginx/" title="Share on LinkedIn" rel="noreferrer nofollow"><span><svg style="vertical-align: -0.25em;" height="30px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></span></a></div></div><div class="right-toc"></div></aside></div><script src="/scalastic.min.js"></script> <script> tocbot.init({ tocSelector: '.right-toc', contentSelector: '.wrap-content', headingSelector: 'h1, h2, h3', ignoreSelector: '.name', orderedList: false, }); </script></body></html>
